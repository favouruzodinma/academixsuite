<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Report Card Generator | Teacher Portal | AcademiXSuite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Merriweather:wght@400;700;900&display=swap');
        
        :root {
            --primary-indigo: #4f46e5;
            --primary-teal: #0d9488;
            --accent-purple: #8b5cf6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --surface-white: #ffffff;
            --bg-light: #f8fafc;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --nigerian-green: #1a5632;
            --nigerian-gold: #d4af37;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-light); 
            color: var(--text-dark); 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Glassmorphism effects */
        .glass-header { 
            background: rgba(255, 255, 255, 0.98); 
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.3);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.5);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);
        }

        /* Toast Notification Styles */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .toast {
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.3s ease forwards;
            opacity: 0;
            transform: translateX(100px);
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .toast-success {
            background: linear-gradient(135deg, #0d9488, #14b8a6);
            color: white;
            border-left: 4px solid #0f766e;
        }
        
        .toast-info {
            background: linear-gradient(135deg, #4f46e5, #6366f1);
            color: white;
            border-left: 4px solid #3730a3;
        }
        
        .toast-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: white;
            border-left: 4px solid #d97706;
        }
        
        .toast-error {
            background: linear-gradient(135deg, #f43f5e, #fb7185);
            color: white;
            border-left: 4px solid #be123c;
        }
        
        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(100px);
            }
        }
        
        .toast-exit {
            animation: fadeOut 0.3s ease forwards;
        }
        
        .toast-icon {
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s;
        }
        
        .toast-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Sidebar styling */
        .sidebar-link { 
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); 
            border-left: 3px solid transparent; 
            position: relative;
        }
        
        .sidebar-link:hover { 
            background: linear-gradient(90deg, rgba(79, 70, 229, 0.05) 0%, rgba(79, 70, 229, 0.02) 100%);
            color: var(--primary-indigo); 
            border-left-color: rgba(79, 70, 229, 0.3);
        }
        
        .active-link { 
            background: linear-gradient(90deg, rgba(79, 70, 229, 0.1) 0%, rgba(79, 70, 229, 0.05) 100%);
            color: var(--primary-indigo); 
            border-left-color: var(--primary-indigo); 
            font-weight: 700;
        }
        
        .active-link::before {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 60%;
            background: var(--primary-indigo);
            border-radius: 4px 0 0 4px;
        }

        /* ===== PROFESSIONAL NIGERIAN REPORT CARD STYLES (Updated from Parent Page) ===== */
        .report-card-container {
            background: white;
            border: 1px solid #d1d5db;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .school-header {
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            color: white;
            padding: 24px 0;
            border-bottom: 4px solid #b45309;
        }
        
        .school-header h1 {
            font-family: 'Merriweather', serif;
            font-weight: 900;
        }
        
        .school-motto {
            font-style: italic;
            letter-spacing: 0.5px;
        }
        
        .official-stamp {
            border: 2px dashed #991b1b;
            padding: 12px;
            display: inline-block;
            font-family: 'Merriweather', serif;
            font-weight: 700;
            color: #991b1b;
        }
        
        .subject-table {
            border-collapse: collapse;
            width: 100%;
        }
        
        .subject-table th {
            background: #f3f4f6;
            padding: 10px;
            text-align: center;
            font-weight: 700;
            color: #374151;
            border: 1px solid #d1d5db;
            font-size: 12px;
        }
        
        .subject-table td {
            padding: 10px;
            border: 1px solid #d1d5db;
            text-align: center;
            font-size: 13px;
        }
        
        .subject-table .subject-name {
            text-align: left;
            font-weight: 600;
            color: #1f2937;
        }
        
        .total-row {
            background: #f3f4f6 !important;
            font-weight: 700 !important;
        }
        
        .signature-line {
            border-top: 1px solid #9ca3af;
            width: 200px;
            display: inline-block;
            margin-top: 4px;
        }
        
        .grade-box {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            color: white;
            margin: 0 auto;
        }
        
        .grade-a { background: #065f46; }
        .grade-b { background: #1e40af; }
        .grade-c { background: #b45309; }
        .grade-d { background: #991b1b; }
        .grade-e { background: #7c2d12; }
        .grade-f { background: #1f2937; }

        .watermark {
            position: absolute;
            opacity: 0.1;
            font-size: 120px;
            font-weight: 900;
            color: #1e40af;
            transform: rotate(-45deg);
            pointer-events: none;
            z-index: 0;
        }

        /* Nigerian Report Card Styles (Keep original for compatibility) */
        .nigerian-flag {
            height: 4px;
            background: linear-gradient(to right, #008751 33%, white 33%, white 66%, #008751 66%);
            margin: 10px 0;
        }
        
        .report-card {
            background: white;
            border: 2px solid var(--nigerian-green);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .report-header {
            border-bottom: 3px double var(--nigerian-green);
        }
        
        /* Grade Colors (Nigerian System) - Keep for backward compatibility */
        .grade-row-a { background-color: #d4edda; color: #155724; border-left: 4px solid #155724; }
        .grade-row-b { background-color: #c3e6cb; color: #0f5132; border-left: 4px solid #0f5132; }
        .grade-row-c { background-color: #fff3cd; color: #856404; border-left: 4px solid #856404; }
        .grade-row-d { background-color: #f8d7da; color: #721c24; border-left: 4px solid #721c24; }
        .grade-row-e { background-color: #f5c6cb; color: #491217; border-left: 4px solid #491217; }
        .grade-row-f { background-color: #dc3545; color: white; border-left: 4px solid #8b0000; }
        
        /* Grade Badge */
        .grade-badge {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 16px;
            color: white;
        }
        
        .badge-a { background: linear-gradient(135deg, #0d9488, #14b8a6); }
        .badge-b { background: linear-gradient(135deg, #4f46e5, #6366f1); }
        .badge-c { background: linear-gradient(135deg, #f59e0b, #fbbf24); }
        .badge-d { background: linear-gradient(135deg, #f43f5e, #fb7185); }
        .badge-f { background: linear-gradient(135deg, #991b1b, #dc2626); }
        
        /* Metric Cards */
        .metric-card {
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--metric-color), transparent);
        }
        
        .metric-primary {
            --metric-color: var(--primary-indigo);
        }
        
        .metric-success {
            --metric-color: var(--primary-teal);
        }
        
        .metric-warning {
            --metric-color: var(--accent-amber);
        }
        
        .metric-danger {
            --metric-color: var(--accent-rose);
        }
        
        .metric-purple {
            --metric-color: var(--accent-purple);
        }
        
        .metric-green {
            --metric-color: var(--nigerian-green);
        }
        
        /* Progress Steps */
        .progress-step {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .progress-step.active {
            background: linear-gradient(135deg, var(--primary-indigo), var(--accent-purple));
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
        
        .progress-step.completed {
            background: linear-gradient(135deg, var(--primary-teal), #14b8a6);
            color: white;
        }
        
        .progress-step.inactive {
            background: #e2e8f0;
            color: #64748b;
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Animation for cards */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        /* Action Buttons */
        .action-btn {
            padding: 8px 16px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .action-btn-primary {
            background: linear-gradient(135deg, var(--primary-indigo), var(--accent-purple));
            color: white;
        }
        
        .action-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }
        
        .action-btn-secondary {
            background: white;
            color: var(--primary-indigo);
            border: 1px solid #e2e8f0;
        }
        
        .action-btn-secondary:hover {
            background: #f8fafc;
            border-color: var(--primary-indigo);
        }
        
        .action-btn-success {
            background: linear-gradient(135deg, var(--nigerian-green), #2e8b57);
            color: white;
        }
        
        .action-btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(26, 86, 50, 0.3);
        }

        /* Tab styling */
        .tab-button {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            color: #64748b;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .tab-button:hover {
            color: var(--primary-indigo);
        }
        
        .tab-button.active {
            color: var(--primary-indigo);
            border-bottom-color: var(--primary-indigo);
            background: linear-gradient(to top, rgba(79, 70, 229, 0.05), transparent);
        }

        /* Performance Meter */
        .performance-meter {
            height: 8px;
            border-radius: 4px;
            background: #f1f5f9;
            overflow: hidden;
            position: relative;
        }
        
        .performance-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .performance-excellent { background: linear-gradient(90deg, #0d9488, #14b8a6); }
        .performance-good { background: linear-gradient(90deg, #4f46e5, #6366f1); }
        .performance-average { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .performance-poor { background: linear-gradient(90deg, #f43f5e, #fb7185); }

        /* Grade Input */
        .grade-input {
            width: 60px;
            padding: 8px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .grade-input:focus {
            outline: none;
            border-color: var(--primary-indigo);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .grade-input.grade-a { border-color: #0d9488; background: rgba(13, 148, 136, 0.05); }
        .grade-input.grade-b { border-color: #4f46e5; background: rgba(79, 70, 229, 0.05); }
        .grade-input.grade-c { border-color: #f59e0b; background: rgba(245, 158, 11, 0.05); }
        .grade-input.grade-d { border-color: #f43f5e; background: rgba(244, 63, 94, 0.05); }

        /* Grade Table */
        .grade-table th {
            background: #f8fafc;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 12px;
            color: #64748b;
        }
        
        .grade-table tr {
            transition: all 0.2s ease;
        }
        
        .grade-table tr:hover {
            background: #f8fafc;
        }

        /* Loader Animation */
        .loader {
            width: 48px;
            height: 48px;
            border: 4px solid #f1f5f9;
            border-top-color: var(--primary-indigo);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            padding: 60px 20px;
            text-align: center;
            border: 2px dashed #e2e8f0;
            border-radius: 20px;
            background: #f8fafc;
        }
        
        .empty-state-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 32px;
            color: #94a3b8;
        }

        /* Student Photo Placeholder */
        .student-photo {
            width: 120px;
            height: 150px;
            background: linear-gradient(135deg, #e9ecef, #dee2e6);
            border: 2px solid var(--nigerian-green);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 14px;
            border-radius: 8px;
        }

        /* Notification Bell */
        .notification-bell {
            position: relative;
            cursor: pointer;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #f43f5e, #fb7185);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 900;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .glass-header {
                backdrop-filter: none;
                -webkit-backdrop-filter: none;
                background: white;
            }
            
            .toast-container {
                left: 20px;
                right: 20px;
                max-width: none;
            }
            
            .chart-container {
                height: 250px !important;
            }
            
            .school-header {
                padding: 16px 0;
            }
            
            .school-header h1 {
                font-size: 1.5rem;
            }
        }

        /* Print Styles */
        @media print {
            .no-print {
                display: none !important;
            }
            
            .report-card {
                border: 3px solid #000;
                box-shadow: none;
                page-break-inside: avoid;
            }
            
            .page-break {
                page-break-before: always;
            }
            
            body {
                background: white !important;
            }
        }
    </style>
</head>
<body class="antialiased selection:bg-indigo-100 selection:text-indigo-900">

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-[99] lg:hidden hidden" onclick="mobileSidebarToggle()"></div>

    <!-- Professional Nigerian Report Card Modal -->
    <div id="reportCardModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden">
        <div class="bg-white rounded-lg w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto report-card-container">
            <div id="reportCardContent">
                <!-- Professional Nigerian-style report card loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Report Card Generator Modal -->
    <div id="reportGeneratorModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden">
        <div class="bg-white rounded-2xl w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h3 class="text-2xl font-black text-slate-900">Generate Report Cards</h3>
                        <p class="text-sm text-slate-600">Create professional Nigerian-style report cards for your class</p>
                    </div>
                    <button onclick="closeModal('reportGeneratorModal')" class="text-slate-400 hover:text-slate-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Progress Steps -->
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div class="text-center">
                            <div class="progress-step active mx-auto mb-2">1</div>
                            <span class="text-xs font-medium text-slate-700">Select Class</span>
                        </div>
                        <div class="flex-1 h-1 bg-slate-200 mx-4"></div>
                        <div class="text-center">
                            <div class="progress-step inactive mx-auto mb-2">2</div>
                            <span class="text-xs text-slate-500">Enter Grades</span>
                        </div>
                        <div class="flex-1 h-1 bg-slate-200 mx-4"></div>
                        <div class="text-center">
                            <div class="progress-step inactive mx-auto mb-2">3</div>
                            <span class="text-xs text-slate-500">Add Comments</span>
                        </div>
                        <div class="flex-1 h-1 bg-slate-200 mx-4"></div>
                        <div class="text-center">
                            <div class="progress-step inactive mx-auto mb-2">4</div>
                            <span class="text-xs text-slate-500">Generate</span>
                        </div>
                    </div>
                </div>
                
                <!-- Step 1: Class Selection -->
                <div id="step1" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="glass-card rounded-xl p-6 hover:border-indigo-300 hover:shadow-lg cursor-pointer transition-all duration-300"
                             onclick="selectClass('ss2_science')">
                            <div class="flex items-center justify-between mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center">
                                    <i class="fas fa-flask text-indigo-600 text-xl"></i>
                                </div>
                                <span class="text-xs font-bold bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full">24 Students</span>
                            </div>
                            <h4 class="font-bold text-lg text-slate-900 mb-2">SS 2 Science</h4>
                            <p class="text-sm text-slate-600 mb-4">Physics, Chemistry, Biology, Mathematics</p>
                            <div class="text-sm">
                                <span class="font-medium text-slate-700">Class Teacher:</span>
                                <span class="ml-2">Mr. T. O. Babalola</span>
                            </div>
                        </div>
                        
                        <div class="glass-card rounded-xl p-6 hover:border-teal-300 hover:shadow-lg cursor-pointer transition-all duration-300"
                             onclick="selectClass('ss2_arts')">
                            <div class="flex items-center justify-between mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-teal-100 to-emerald-100 flex items-center justify-center">
                                    <i class="fas fa-palette text-teal-600 text-xl"></i>
                                </div>
                                <span class="text-xs font-bold bg-teal-100 text-teal-800 px-2 py-1 rounded-full">22 Students</span>
                            </div>
                            <h4 class="font-bold text-lg text-slate-900 mb-2">SS 2 Arts</h4>
                            <p class="text-sm text-slate-600 mb-4">Literature, Government, CRK, History</p>
                            <div class="text-sm">
                                <span class="font-medium text-slate-700">Class Teacher:</span>
                                <span class="ml-2">Mrs. A. S. Adebayo</span>
                            </div>
                        </div>
                        
                        <div class="glass-card rounded-xl p-6 hover:border-amber-300 hover:shadow-lg cursor-pointer transition-all duration-300"
                             onclick="selectClass('ss2_commercial')">
                            <div class="flex items-center justify-between mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-amber-100 to-yellow-100 flex items-center justify-center">
                                    <i class="fas fa-chart-line text-amber-600 text-xl"></i>
                                </div>
                                <span class="text-xs font-bold bg-amber-100 text-amber-800 px-2 py-1 rounded-full">20 Students</span>
                            </div>
                            <h4 class="font-bold text-lg text-slate-900 mb-2">SS 2 Commercial</h4>
                            <p class="text-sm text-slate-600 mb-4">Accounting, Commerce, Economics</p>
                            <div class="text-sm">
                                <span class="font-medium text-slate-700">Class Teacher:</span>
                                <span class="ml-2">Mr. C. O. Nwankwo</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between pt-6 border-t border-slate-200">
                        <button onclick="closeModal('reportGeneratorModal')" class="px-6 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition">
                            Cancel
                        </button>
                        <button onclick="nextStep(2)" class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200">
                            Next: Enter Grades
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Grade Entry -->
                <div id="step2" class="hidden space-y-6">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h4 class="font-bold text-lg text-slate-900">Enter Grades for <span id="selectedClassName" class="text-indigo-600">SS 2 Science</span></h4>
                            <p class="text-sm text-slate-600">Term: Third Term 2023/2024 Session</p>
                        </div>
                        <button onclick="autoFillGrades()" class="action-btn action-btn-secondary">
                            <i class="fas fa-magic"></i>
                            Auto-Fill Sample Grades
                        </button>
                    </div>
                    
                    <div class="overflow-y-auto max-h-96 mb-6">
                        <table class="w-full grade-table">
                            <thead>
                                <tr class="border-b border-slate-200">
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Student</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">CA1 (20)</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">CA2 (20)</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Exam (60)</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Total</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Grade</th>
                                    <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Position</th>
                                </tr>
                            </thead>
                            <tbody id="gradeEntryTable">
                                <!-- Grade entry rows will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="flex justify-between pt-6 border-t border-slate-200">
                        <button onclick="prevStep(1)" class="px-6 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Back
                        </button>
                        <button onclick="nextStep(3)" class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200">
                            Next: Add Comments
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Comments -->
                <div id="step3" class="hidden space-y-6">
                    <div class="mb-6">
                        <h4 class="font-bold text-lg text-slate-900">Add Comments & Signatures</h4>
                        <p class="text-sm text-slate-600">Customize teacher remarks and principal's comments</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Teacher's Remarks Template</label>
                            <select id="remarksTemplate" class="w-full p-3 border border-slate-300 rounded-xl text-slate-700" onchange="applyRemarkTemplate()">
                                <option value="">Select Template</option>
                                <option value="excellent">Excellent Performance</option>
                                <option value="very_good">Very Good Performance</option>
                                <option value="good">Good Performance</option>
                                <option value="average">Average Performance</option>
                                <option value="needs_improvement">Needs Improvement</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Class Position Format</label>
                            <select id="positionFormat" class="w-full p-3 border border-slate-300 rounded-xl text-slate-700">
                                <option value="out_of">5th out of 45</option>
                                <option value="only">5th Position</option>
                                <option value="percentage">Top 11%</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Teacher's General Remarks</label>
                        <textarea id="teacherRemarks" class="w-full p-4 border border-slate-300 rounded-xl text-slate-700 min-h-[120px]" rows="4">
The student has shown commendable performance this term. There is notable improvement in Mathematics and Sciences. Regular attendance and participation in class activities are appreciated. Continue to work hard in the coming terms.
                        </textarea>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Principal's Comment</label>
                        <textarea id="principalComment" class="w-full p-4 border border-slate-300 rounded-xl text-slate-700 min-h-[100px]" rows="3">
A satisfactory performance. Keep up the good work and continue to strive for excellence. Your dedication to academic excellence is noted and appreciated.
                        </textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Class Teacher's Name</label>
                            <input type="text" id="teacherName" class="w-full p-3 border border-slate-300 rounded-xl text-slate-700" value="Mr. T. O. Babalola">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">Principal's Name</label>
                            <input type="text" id="principalName" class="w-full p-3 border border-slate-300 rounded-xl text-slate-700" value="Mrs. A. B. Williams">
                        </div>
                    </div>
                    
                    <div class="flex justify-between pt-6 border-t border-slate-200">
                        <button onclick="prevStep(2)" class="px-6 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Back
                        </button>
                        <button onclick="nextStep(4)" class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200">
                            Next: Generate Reports
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 4: Generation -->
                <div id="step4" class="hidden space-y-6">
                    <div class="text-center py-8">
                        <div class="w-20 h-20 rounded-full bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-file-alt text-indigo-600 text-3xl"></i>
                        </div>
                        <h4 class="font-bold text-2xl text-slate-900 mb-2">Ready to Generate Reports!</h4>
                        <p class="text-slate-600 mb-8">Generate professional report cards for all students in the selected class</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="glass-card rounded-xl p-6 text-center">
                                <div class="text-3xl font-black text-indigo-600" id="studentCount">24</div>
                                <div class="text-sm text-slate-600">Students</div>
                            </div>
                            <div class="glass-card rounded-xl p-6 text-center">
                                <div class="text-3xl font-black text-teal-600" id="subjectCount">12</div>
                                <div class="text-sm text-slate-600">Subjects Each</div>
                            </div>
                            <div class="glass-card rounded-xl p-6 text-center">
                                <div class="text-3xl font-black text-purple-600">24</div>
                                <div class="text-sm text-slate-600">Reports to Generate</div>
                            </div>
                        </div>
                        
                        <div class="mb-8">
                            <label class="block text-sm font-bold text-slate-700 mb-4">Output Format:</label>
                            <div class="flex justify-center space-x-8">
                                <label class="flex items-center">
                                    <input type="radio" name="outputFormat" value="pdf" checked class="mr-3 h-5 w-5 text-indigo-600">
                                    <span class="text-slate-700">PDF Format</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="outputFormat" value="print" class="mr-3 h-5 w-5 text-indigo-600">
                                    <span class="text-slate-700">Print Directly</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="outputFormat" value="bulk" class="mr-3 h-5 w-5 text-indigo-600">
                                    <span class="text-slate-700">Bulk PDF (All)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between pt-6 border-t border-slate-200">
                        <button onclick="prevStep(3)" class="px-6 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Back
                        </button>
                        <button onclick="generateAllReports()" class="px-6 py-3 bg-gradient-to-r from-teal-600 to-emerald-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-teal-200">
                            <i class="fas fa-play mr-2"></i>
                            Generate All Reports
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Preview Modal -->
    <div id="reportPreviewModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden overflow-auto">
        <div class="bg-white rounded-2xl w-full max-w-4xl mx-4 my-8 max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-black text-slate-900">
                        <i class="fas fa-eye text-indigo-600 mr-2"></i>
                        Report Card Preview
                    </h3>
                    <div class="flex space-x-3">
                        <button onclick="printPreview()" class="action-btn action-btn-secondary">
                            <i class="fas fa-print"></i>
                            Print
                        </button>
                        <button onclick="closeModal('reportPreviewModal')" class="text-slate-400 hover:text-slate-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Report Preview -->
                <div id="reportPreview" class="report-card p-6">
                    <!-- Report will be generated here -->
                </div>
                
                <div class="flex justify-end space-x-4 mt-6">
                    <button onclick="closeModal('reportPreviewModal')" class="px-6 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition">
                        Close
                    </button>
                    <button onclick="downloadReportPDF()" class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200">
                        <i class="fas fa-download mr-2"></i>
                        Download as PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="flex h-screen overflow-hidden">
        
        <!-- Sidebar -->
        <aside id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-white border-r border-slate-200 z-[100] lg:relative lg:translate-x-0 -translate-x-full transition-transform duration-300 flex flex-col shadow-xl lg:shadow-none">
            
            <!-- Teacher Header -->
            <div class="h-20 flex items-center px-6 border-b border-slate-100">
                <div class="flex items-center gap-3">
                    <div class="relative">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-600 to-purple-600 flex items-center justify-center shadow-lg shadow-indigo-100">
                            <i class="fas fa-chalkboard-teacher text-white text-lg"></i>
                        </div>
                        <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-teal-500 border-2 border-white rounded-full"></div>
                    </div>
                    <div>
                        <span class="text-lg font-black tracking-tight text-slate-900">Mr. Davis</span>
                        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5">TEACHER PORTAL</p>
                    </div>
                </div>
            </div>

            <!-- Teacher Quick Info -->
            <div class="p-6 border-b border-slate-100">
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-slate-600">Reports Generated:</span>
                        <span class="text-sm font-black text-indigo-600">142</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-slate-600">Pending:</span>
                        <span class="text-sm font-bold text-amber-600">3</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-slate-600">Avg. Time Saved:</span>
                        <span class="text-sm font-bold text-teal-600">42h</span>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex-1 overflow-y-auto py-6 space-y-8 custom-scrollbar">
                <div>
                    <p class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3">Dashboard</p>
                    <nav class="space-y-1">
                        <a href="teacher-dashboard.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-home"></i>
                            </div>
                            <span>Overview</span>
                        </a>
                        <a href="teacher-classes.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-users-class"></i>
                            </div>
                            <span>My Classes</span>
                        </a>
                        <a href="teacher-schedule.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <span>Schedule</span>
                        </a>
                    </nav>
                </div>

                <div>
                    <p class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3">Academic</p>
                    <nav class="space-y-1">
                        <a href="teacher-attendance.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <span>Attendance</span>
                        </a>
                        <a href="teacher-grades.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <span>Grades & Assessment</span>
                        </a>
                        <a href="#" class="sidebar-link active-link flex items-center gap-3 px-6 py-3 text-sm font-semibold">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <span>Report Cards</span>
                            <span class="ml-auto bg-amber-100 text-amber-700 text-xs font-bold px-2 py-1 rounded-full">3</span>
                        </a>
                    </nav>
                </div>

                <div>
                    <p class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3">Communication</p>
                    <nav class="space-y-1">
                        <a href="teacher-messages.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-comments"></i>
                            </div>
                            <span>Messages</span>
                            <span class="ml-auto bg-indigo-100 text-indigo-700 text-xs font-bold px-2 py-1 rounded-full">3</span>
                        </a>
                        <a href="teacher-announcements.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-bullhorn"></i>
                            </div>
                            <span>Announcements</span>
                        </a>
                        <a href="teacher-parents.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-user-friends"></i>
                            </div>
                            <span>Parent Contacts</span>
                        </a>
                    </nav>
                </div>

                <div>
                    <p class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3">Resources</p>
                    <nav class="space-y-1">
                        <a href="teacher-resources.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <span>Lesson Materials</span>
                        </a>
                        <a href="teacher-reports.html" class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600">
                            <div class="w-5 h-5 flex items-center justify-center">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <span>Reports & Analytics</span>
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Bottom Section -->
            <div class="p-6 border-t border-slate-100 space-y-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-9 h-9 rounded-xl bg-slate-100 flex items-center justify-center">
                            <i class="fas fa-cog text-slate-600"></i>
                        </div>
                        <a href="teacher-settings.html" class="text-sm font-medium text-slate-600 hover:text-indigo-600">Settings</a>
                    </div>
                </div>
                <button onclick="showToast('Logout successful', 'success')" class="w-full py-3 bg-gradient-to-r from-slate-100 to-slate-50 border border-slate-200 text-slate-700 font-bold rounded-xl hover:shadow-md transition-all flex items-center justify-center gap-2">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            
            <!-- Header -->
            <header class="glass-header h-20 px-6 flex items-center justify-between border-b border-slate-200/50">
                <div class="flex items-center gap-4">
                    <button onclick="mobileSidebarToggle()" class="lg:hidden w-10 h-10 rounded-xl flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div>
                        <h1 class="text-2xl font-black text-slate-900">Report Card Generator</h1>
                        <p class="text-sm text-slate-600">Create professional Nigerian-style report cards automatically</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Quick Actions -->
                    <div class="hidden md:flex items-center gap-2">
                        <button onclick="openReportGenerator()" class="action-btn action-btn-primary">
                            <i class="fas fa-plus-circle"></i>
                            <span>Generate Reports</span>
                        </button>
                        <button onclick="loadTemplates()" class="action-btn action-btn-secondary">
                            <i class="fas fa-history"></i>
                            <span>Load Templates</span>
                        </button>
                        <button onclick="viewProfessionalReportCard('sample')" class="action-btn action-btn-success">
                            <i class="fas fa-eye"></i>
                            <span>View Sample</span>
                        </button>
                    </div>
                    
                    <!-- Notifications -->
                    <div class="notification-bell relative">
                        <button onclick="toggleNotifications()" class="w-10 h-10 rounded-xl flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600">
                            <i class="fas fa-bell"></i>
                        </button>
                        <div class="notification-badge">3</div>
                        
                        <!-- Notification Dropdown -->
                        <div id="notificationDropdown" class="absolute right-0 mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-slate-200 p-4 hidden z-50">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-slate-900">Notifications</h3>
                                <button class="text-xs text-indigo-600 font-bold">Mark all as read</button>
                            </div>
                            <div class="space-y-3 max-h-64 overflow-y-auto">
                                <div class="message-card unread">
                                    <div class="flex gap-3">
                                        <div class="message-avatar avatar-admin">A</div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-900">Report Card Deadline</p>
                                            <p class="text-xs text-slate-600">Term 3 reports due in 5 days</p>
                                            <p class="text-xs text-slate-400 mt-1">2 hours ago</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="message-card">
                                    <div class="flex gap-3">
                                        <div class="message-avatar avatar-parent">P</div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-900">Report Inquiry</p>
                                            <p class="text-xs text-slate-600">Mrs. Johnson requested report review</p>
                                            <p class="text-xs text-slate-400 mt-1">5 hours ago</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="message-card unread">
                                    <div class="flex gap-3">
                                        <div class="message-avatar avatar-student">S</div>
                                        <div>
                                            <p class="text-sm font-bold text-slate-900">Report Card Generated</p>
                                            <p class="text-xs text-slate-600">SS 2 Science reports completed</p>
                                            <p class="text-xs text-slate-400 mt-1">Yesterday</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <a href="teacher-notifications.html" class="block text-center text-sm text-indigo-600 font-bold mt-4 pt-4 border-t border-slate-100 hover:text-indigo-800">
                                View all notifications
                            </a>
                        </div>
                    </div>
                    
                    <!-- User Profile -->
                    <div class="relative">
                        <button onclick="toggleProfileMenu()" class="flex items-center gap-3 p-2 rounded-xl hover:bg-slate-100">
                            <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-indigo-600 to-purple-600 flex items-center justify-center text-white font-bold">
                                JD
                            </div>
                            <div class="hidden md:block text-left">
                                <p class="text-sm font-bold text-slate-900">John Davis</p>
                                <p class="text-xs text-slate-600">Mathematics Teacher</p>
                            </div>
                            <i class="fas fa-chevron-down text-slate-400 text-xs hidden md:block"></i>
                        </button>
                        
                        <!-- Profile Dropdown -->
                        <div id="profileDropdown" class="absolute right-0 mt-2 w-56 bg-white rounded-2xl shadow-2xl border border-slate-200 p-4 hidden z-50">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-600 to-purple-600 flex items-center justify-center text-white font-bold text-lg">
                                    JD
                                </div>
                                <div>
                                    <p class="font-bold text-slate-900">John Davis</p>
                                    <p class="text-xs text-slate-600">jdavis@academix.edu</p>
                                </div>
                            </div>
                            <div class="space-y-1">
                                <a href="teacher-profile.html" class="flex items-center gap-3 px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg">
                                    <i class="fas fa-user w-5"></i>
                                    <span>My Profile</span>
                                </a>
                                <a href="teacher-settings.html" class="flex items-center gap-3 px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg">
                                    <i class="fas fa-cog w-5"></i>
                                    <span>Account Settings</span>
                                </a>
                                <a href="teacher-help.html" class="flex items-center gap-3 px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg">
                                    <i class="fas fa-question-circle w-5"></i>
                                    <span>Help & Support</span>
                                </a>
                            </div>
                            <div class="border-t border-slate-200 mt-4 pt-4">
                                <button onclick="showToast('Logout successful', 'success')" class="w-full flex items-center justify-center gap-2 text-sm font-bold text-rose-600 hover:text-rose-800 py-2">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content Area -->
            <main class="flex-1 overflow-y-auto p-6 custom-scrollbar">
                <!-- Performance Overview -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="glass-card metric-card metric-success rounded-2xl p-6 animate-fadeInUp" style="animation-delay: 0.1s">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-bold text-slate-600 mb-1">Total Reports Generated</p>
                                <p class="text-3xl font-black text-slate-900">142</p>
                            </div>
                            <div class="w-12 h-12 rounded-xl bg-teal-100 flex items-center justify-center">
                                <i class="fas fa-file-alt text-teal-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3"><span class="font-bold text-emerald-600">+12</span> this week</p>
                    </div>
                    
                    <div class="glass-card metric-card metric-primary rounded-2xl p-6 animate-fadeInUp" style="animation-delay: 0.2s">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-bold text-slate-600 mb-1">Pending Reports</p>
                                <p class="text-3xl font-black text-slate-900">3</p>
                            </div>
                            <div class="w-12 h-12 rounded-xl bg-indigo-100 flex items-center justify-center">
                                <i class="fas fa-clock text-indigo-600 text-xl"></i>
                            </div>
                        </div>
                        <button onclick="viewPendingReports()" class="text-xs text-indigo-600 font-bold mt-3 hover:text-indigo-800">
                            View pending 
                        </button>
                    </div>
                    
                    <div class="glass-card metric-card metric-warning rounded-2xl p-6 animate-fadeInUp" style="animation-delay: 0.3s">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-bold text-slate-600 mb-1">Time Saved</p>
                                <p class="text-3xl font-black text-slate-900">42h</p>
                            </div>
                            <div class="w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center">
                                <i class="fas fa-stopwatch text-amber-600 text-xl"></i>
                            </div>
                        </div>
                        <div class="performance-meter w-full mt-3">
                            <div class="performance-fill performance-good" style="width: 85%"></div>
                        </div>
                    </div>
                    
                    <div class="glass-card metric-card metric-green rounded-2xl p-6 animate-fadeInUp" style="animation-delay: 0.4s">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-bold text-slate-600 mb-1">Completion Rate</p>
                                <p class="text-3xl font-black text-slate-900">92%</p>
                            </div>
                            <div class="w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-600 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3"><span class="font-bold text-emerald-600">+8%</span> vs last term</p>
                    </div>
                </div>

                <!-- Main Content Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Left Column - Recent Reports -->
                    <div class="lg:col-span-2">
                        <div class="glass-card rounded-2xl p-6">
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h2 class="text-xl font-black text-slate-900">Recent Report Cards</h2>
                                    <p class="text-sm text-slate-600">Generated reports for this term</p>
                                </div>
                                <button onclick="openReportGenerator()" class="action-btn action-btn-primary">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>New Report</span>
                                </button>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-slate-200">
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Student Name</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Class</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Term</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Average Score</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Position</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Status</th>
                                            <th class="text-left py-4 px-4 text-sm font-bold text-slate-600">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-100 hover:bg-slate-50 transition-colors">
                                            <td class="py-4 px-4">
                                                <div class="flex items-center gap-3">
                                                    <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600">
                                                        A
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-slate-900">Adekunle Chinedu</p>
                                                        <p class="text-xs text-slate-500">ECSS/2021/0456</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">SS 2 Science</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm text-slate-600">Term 3 2023/2024</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="font-bold text-emerald-600">82.5%</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">5th/45</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-bold">
                                                    Generated
                                                </span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex gap-2">
                                                    <button onclick="viewProfessionalReportCard('alex')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-eye text-xs"></i>
                                                    </button>
                                                    <button onclick="downloadReport('alex')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-download text-xs"></i>
                                                    </button>
                                                    <button onclick="printReport('alex')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-print text-xs"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                        <tr class="border-b border-slate-100 hover:bg-slate-50 transition-colors">
                                            <td class="py-4 px-4">
                                                <div class="flex items-center gap-3">
                                                    <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600">
                                                        B
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-slate-900">Babatunde Fatima</p>
                                                        <p class="text-xs text-slate-500">ECSS/2021/0457</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">SS 2 Science</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm text-slate-600">Term 3 2023/2024</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="font-bold text-indigo-600">78.2%</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">12th/45</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-bold">
                                                    Generated
                                                </span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex gap-2">
                                                    <button onclick="viewProfessionalReportCard('sarah')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-eye text-xs"></i>
                                                    </button>
                                                    <button onclick="downloadReport('sarah')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-download text-xs"></i>
                                                    </button>
                                                    <button onclick="printReport('sarah')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-print text-xs"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                        <tr class="border-b border-slate-100 hover:bg-slate-50 transition-colors">
                                            <td class="py-4 px-4">
                                                <div class="flex items-center gap-3">
                                                    <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600">
                                                        C
                                                    </div>
                                                    <div>
                                                        <p class="text-sm font-medium text-slate-900">Chukwu Emmanuel</p>
                                                        <p class="text-xs text-slate-500">ECSS/2021/0458</p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">SS 2 Arts</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm text-slate-600">Term 3 2023/2024</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="font-bold text-amber-600">65.8%</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="text-sm font-medium text-slate-700">25th/40</span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <span class="px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-xs font-bold">
                                                    Pending Review
                                                </span>
                                            </td>
                                            <td class="py-4 px-4">
                                                <div class="flex gap-2">
                                                    <button onclick="viewProfessionalReportCard('sample3')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-eye text-xs"></i>
                                                    </button>
                                                    <button onclick="editReport('sample3')" class="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center">
                                                        <i class="fas fa-edit text-xs"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column - Quick Actions -->
                    <div class="space-y-6">
                        <!-- Quick Actions -->
                        <div class="glass-card rounded-2xl p-6">
                            <h2 class="text-xl font-black text-slate-900 mb-6">Quick Actions</h2>
                            <div class="space-y-3">
                                <button onclick="openReportGenerator()" class="w-full text-left p-3 border border-slate-200 rounded-xl hover:bg-slate-50 flex items-center gap-3 transition-colors">
                                    <div class="w-10 h-10 rounded-lg bg-indigo-100 flex items-center justify-center">
                                        <i class="fas fa-plus-circle text-indigo-600"></i>
                                    </div>
                                    <span class="text-sm font-medium text-slate-900">Generate New Reports</span>
                                </button>
                                <button onclick="loadTemplates()" class="w-full text-left p-3 border border-slate-200 rounded-xl hover:bg-slate-50 flex items-center gap-3 transition-colors">
                                    <div class="w-10 h-10 rounded-lg bg-teal-100 flex items-center justify-center">
                                        <i class="fas fa-file-import text-teal-600"></i>
                                    </div>
                                    <span class="text-sm font-medium text-slate-900">Load Templates</span>
                                </button>
                                <button onclick="exportAllReports()" class="w-full text-left p-3 border border-slate-200 rounded-xl hover:bg-slate-50 flex items-center gap-3 transition-colors">
                                    <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                                        <i class="fas fa-download text-purple-600"></i>
                                    </div>
                                    <span class="text-sm font-medium text-slate-900">Export All Reports</span>
                                </button>
                                <button onclick="viewStatistics()" class="w-full text-left p-3 border border-slate-200 rounded-xl hover:bg-slate-50 flex items-center gap-3 transition-colors">
                                    <div class="w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center">
                                        <i class="fas fa-chart-bar text-amber-600"></i>
                                    </div>
                                    <span class="text-sm font-medium text-slate-900">View Statistics</span>
                                </button>
                            </div>
                        </div>

                        <!-- Report Templates -->
                        <div class="glass-card rounded-2xl p-6">
                            <h2 class="text-xl font-black text-slate-900 mb-6">Saved Templates</h2>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center">
                                            <i class="fas fa-school text-indigo-600 text-sm"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-slate-900">Nigerian Standard</p>
                                            <p class="text-xs text-slate-500">Primary School</p>
                                        </div>
                                    </div>
                                    <button onclick="loadTemplate('nigerian_standard')" class="text-xs text-indigo-600 font-bold hover:text-indigo-800">
                                        Load
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-teal-100 flex items-center justify-center">
                                            <i class="fas fa-graduation-cap text-teal-600 text-sm"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-slate-900">WAEC Format</p>
                                            <p class="text-xs text-slate-500">Secondary School</p>
                                        </div>
                                    </div>
                                    <button onclick="loadTemplate('waec_format')" class="text-xs text-indigo-600 font-bold hover:text-indigo-800">
                                        Load
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center">
                                            <i class="fas fa-flask text-amber-600 text-sm"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-slate-900">Science Class</p>
                                            <p class="text-xs text-slate-500">With Lab Scores</p>
                                        </div>
                                    </div>
                                    <button onclick="loadTemplate('science_class')" class="text-xs text-indigo-600 font-bold hover:text-indigo-800">
                                        Load
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="glass-card rounded-2xl p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-xl font-black text-slate-900">Class Performance</h2>
                                <p class="text-sm text-slate-600">Average scores by subject</p>
                            </div>
                            <select class="text-sm border border-slate-300 rounded-xl px-3 py-2 text-slate-700">
                                <option>SS 2 Science</option>
                                <option>SS 2 Arts</option>
                                <option>SS 2 Commercial</option>
                            </select>
                        </div>
                        <div class="h-64">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-2xl p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-xl font-black text-slate-900">Grade Distribution</h2>
                                <p class="text-sm text-slate-600">Term 3 2023/2024 Results</p>
                            </div>
                            <div class="flex gap-2">
                                <button class="tab-button active" onclick="changeTerm('term3')">Term 3</button>
                                <button class="tab-button" onclick="changeTerm('term2')">Term 2</button>
                                <button class="tab-button" onclick="changeTerm('term1')">Term 1</button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="gradeDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Global Variables
        let selectedClass = 'ss2_science';
        let currentStep = 1;
        let studentsData = [];
        let notificationsVisible = false;
        let profileMenuVisible = false;
        let performanceChart = null;
        let gradeDistributionChart = null;

        // Initialize on DOM load
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            loadSampleStudents();
            updateStepIndicators();
            showToast('Report card generator loaded successfully', 'success', 3000);
        });

        // Initialize Charts
        function initializeCharts() {
            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: ['Mathematics', 'Physics', 'Chemistry', 'Biology', 'English', 'Computer', 'Civic', 'Agric'],
                    datasets: [{
                        label: 'Average Score (%)',
                        data: [78, 82, 75, 80, 85, 88, 70, 77],
                        backgroundColor: [
                            'rgba(79, 70, 229, 0.7)',
                            'rgba(13, 148, 136, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(139, 92, 246, 0.7)',
                            'rgba(26, 86, 50, 0.7)',
                            'rgba(244, 63, 94, 0.7)',
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)'
                        ],
                        borderColor: [
                            'rgb(79, 70, 229)',
                            'rgb(13, 148, 136)',
                            'rgb(245, 158, 11)',
                            'rgb(139, 92, 246)',
                            'rgb(26, 86, 50)',
                            'rgb(244, 63, 94)',
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                drawBorder: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '%';
                                }
                            }
                        }
                    }
                }
            });

            // Grade Distribution Chart
            const gradeCtx = document.getElementById('gradeDistributionChart').getContext('2d');
            gradeDistributionChart = new Chart(gradeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['A (75-100%)', 'B (60-74%)', 'C (50-59%)', 'D (45-49%)', 'E (40-44%)', 'F (0-39%)'],
                    datasets: [{
                        data: [15, 25, 30, 15, 10, 5],
                        backgroundColor: [
                            'rgba(13, 148, 136, 0.8)',
                            'rgba(79, 70, 229, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(244, 63, 94, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(220, 38, 38, 0.8)'
                        ],
                        borderColor: 'white',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + ' students';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Load Sample Students Data
        function loadSampleStudents() {
            studentsData = [
                {
                    id: 1,
                    name: "Adekunle Chinedu",
                    regNo: "ECSS/2021/0456",
                    ca1: 18,
                    ca2: 17,
                    exam: 52,
                    total: 87,
                    grade: "A",
                    position: "5th"
                },
                {
                    id: 2,
                    name: "Babatunde Fatima",
                    regNo: "ECSS/2021/0457",
                    ca1: 16,
                    ca2: 15,
                    exam: 48,
                    total: 79,
                    grade: "B",
                    position: "12th"
                },
                {
                    id: 3,
                    name: "Chukwu Emmanuel",
                    regNo: "ECSS/2021/0458",
                    ca1: 12,
                    ca2: 14,
                    exam: 40,
                    total: 66,
                    grade: "C",
                    position: "25th"
                },
                {
                    id: 4,
                    name: "Eze Chinwe",
                    regNo: "ECSS/2021/0459",
                    ca1: 20,
                    ca2: 19,
                    exam: 56,
                    total: 95,
                    grade: "A",
                    position: "1st"
                },
                {
                    id: 5,
                    name: "Mohammed Aliyu",
                    regNo: "ECSS/2021/0460",
                    ca1: 14,
                    ca2: 13,
                    exam: 38,
                    total: 65,
                    grade: "C",
                    position: "28th"
                }
            ];
            
            renderGradeEntryTable();
        }

        // Render Grade Entry Table
        function renderGradeEntryTable() {
            const table = document.getElementById('gradeEntryTable');
            table.innerHTML = '';
            
            studentsData.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'border-b border-slate-100 hover:bg-slate-50';
                row.innerHTML = `
                    <td class="py-3 px-4">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600">
                                ${student.name.charAt(0)}
                            </div>
                            <div>
                                <p class="text-sm font-medium text-slate-900">${student.name}</p>
                                <p class="text-xs text-slate-500">${student.regNo}</p>
                            </div>
                        </div>
                    </td>
                    <td class="py-3 px-4">
                        <input type="number" min="0" max="20" value="${student.ca1}" 
                               class="grade-input grade-${student.grade.toLowerCase()}"
                               onchange="updateStudentGrade(${student.id}, 'ca1', this.value)">
                    </td>
                    <td class="py-3 px-4">
                        <input type="number" min="0" max="20" value="${student.ca2}" 
                               class="grade-input grade-${student.grade.toLowerCase()}"
                               onchange="updateStudentGrade(${student.id}, 'ca2', this.value)">
                    </td>
                    <td class="py-3 px-4">
                        <input type="number" min="0" max="60" value="${student.exam}" 
                               class="grade-input grade-${student.grade.toLowerCase()}"
                               onchange="updateStudentGrade(${student.id}, 'exam', this.value)">
                    </td>
                    <td class="py-3 px-4">
                        <span class="font-bold text-slate-900">${student.total}</span>
                    </td>
                    <td class="py-3 px-4">
                        <span class="grade-badge badge-${student.grade.toLowerCase()}">${student.grade}</span>
                    </td>
                    <td class="py-3 px-4">
                        <span class="text-sm font-medium text-slate-700">${student.position}</span>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        // Update Student Grade
        function updateStudentGrade(id, type, value) {
            const student = studentsData.find(s => s.id === id);
            if (student) {
                student[type] = parseInt(value) || 0;
                student.total = student.ca1 + student.ca2 + student.exam;
                student.grade = calculateGrade(student.total);
                student.position = calculatePosition(student.total);
                
                // Update table row
                const row = document.querySelector(`tr:nth-child(${id})`);
                if (row) {
                    row.querySelector('td:nth-child(5) span').textContent = student.total;
                    const gradeBadge = row.querySelector('.grade-badge');
                    gradeBadge.className = `grade-badge badge-${student.grade.toLowerCase()}`;
                    gradeBadge.textContent = student.grade;
                    row.querySelector('td:nth-child(7) span').textContent = student.position;
                    
                    // Update input classes
                    const inputs = row.querySelectorAll('.grade-input');
                    inputs.forEach(input => {
                        input.className = `grade-input grade-${student.grade.toLowerCase()}`;
                    });
                }
                
                showToast('Grade updated successfully', 'success');
            }
        }

        // Calculate Grade
        function calculateGrade(score) {
            if (score >= 75) return 'A';
            if (score >= 60) return 'B';
            if (score >= 50) return 'C';
            if (score >= 45) return 'D';
            if (score >= 40) return 'E';
            return 'F';
        }

        // Calculate Position (simplified)
        function calculatePosition(score) {
            const sortedScores = [...studentsData].sort((a, b) => b.total - a.total);
            const position = sortedScores.findIndex(s => s.total === score) + 1;
            const total = studentsData.length;
            
            if (position === 1) return '1st';
            if (position === 2) return '2nd';
            if (position === 3) return '3rd';
            return `${position}th/${total}`;
        }

        // Auto-fill Sample Grades
        function autoFillGrades() {
            studentsData.forEach(student => {
                student.ca1 = Math.floor(Math.random() * 11) + 10; // 10-20
                student.ca2 = Math.floor(Math.random() * 11) + 10; // 10-20
                student.exam = Math.floor(Math.random() * 21) + 40; // 40-60
                student.total = student.ca1 + student.ca2 + student.exam;
                student.grade = calculateGrade(student.total);
            });
            
            // Recalculate positions
            const sorted = [...studentsData].sort((a, b) => b.total - a.total);
            sorted.forEach((student, index) => {
                student.position = `${index + 1}${getOrdinalSuffix(index + 1)}/${studentsData.length}`;
            });
            
            renderGradeEntryTable();
            showToast('Sample grades auto-filled', 'success');
        }

        function getOrdinalSuffix(n) {
            if (n > 3 && n < 21) return 'th';
            switch (n % 10) {
                case 1: return 'st';
                case 2: return 'nd';
                case 3: return 'rd';
                default: return 'th';
            }
        }

        // Modal Functions
        function openReportGenerator() {
            document.getElementById('reportGeneratorModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.body.style.overflow = 'auto';
            if (modalId === 'reportGeneratorModal') {
                currentStep = 1;
                updateStepIndicators();
            }
        }

        // Step Navigation
        function nextStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
            updateStepIndicators();
            
            if (step === 2) {
                const className = document.getElementById('selectedClassName');
                if (selectedClass === 'ss2_science') className.textContent = 'SS 2 Science';
                else if (selectedClass === 'ss2_arts') className.textContent = 'SS 2 Arts';
                else if (selectedClass === 'ss2_commercial') className.textContent = 'SS 2 Commercial';
            }
        }

        function prevStep(step) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
            updateStepIndicators();
        }

        function updateStepIndicators() {
            const steps = document.querySelectorAll('.progress-step');
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed', 'inactive');
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.add('inactive');
                }
            });
        }

        // Select Class
        function selectClass(className) {
            selectedClass = className;
            const cards = document.querySelectorAll('#step1 > div > div');
            cards.forEach(card => {
                card.classList.remove('border-indigo-300', 'border-teal-300', 'border-amber-300');
            });
            
            const selectedCard = event.currentTarget;
            if (className === 'ss2_science') selectedCard.classList.add('border-indigo-300');
            else if (className === 'ss2_arts') selectedCard.classList.add('border-teal-300');
            else if (className === 'ss2_commercial') selectedCard.classList.add('border-amber-300');
            
            showToast('Class selected successfully', 'success');
        }

        // Apply Remark Template
        function applyRemarkTemplate() {
            const template = document.getElementById('remarksTemplate').value;
            const remarks = document.getElementById('teacherRemarks');
            
            const templates = {
                excellent: "An outstanding performance throughout the term. The student has consistently demonstrated excellent understanding of concepts and exceptional problem-solving skills. Shows great initiative and participates actively in class discussions. A model student worthy of emulation.",
                very_good: "A very good performance demonstrated this term. Shows strong understanding of subject matter and applies knowledge effectively. Consistent in assignments and class participation. Continue to maintain this standard.",
                good: "Good performance with room for improvement. Understands basic concepts but needs to work on application skills. Shows interest in learning but needs to be more consistent. With more effort, can achieve better results.",
                average: "Average performance. Needs to pay more attention in class and improve study habits. Shows potential but lacks consistency. Requires additional support and motivation to improve performance.",
                needs_improvement: "Performance needs significant improvement. Shows lack of understanding in key areas. Needs to be more attentive in class and complete assignments regularly. Parental involvement is recommended to monitor progress."
            };
            
            if (templates[template]) {
                remarks.value = templates[template];
                showToast('Template applied successfully', 'success');
            }
        }

        // Generate All Reports
        function generateAllReports() {
            showToast('Generating reports...', 'info');
            
            // Simulate report generation
            setTimeout(() => {
                closeModal('reportGeneratorModal');
                showToast('24 report cards generated successfully!', 'success');
                viewProfessionalReportCard('generated');
            }, 1500);
        }

        // View Professional Nigerian Report Card (Updated from parent page)
        function viewProfessionalReportCard(student) {
            const reportCards = {
                'alex': {
                    name: 'ADEKUNLE CHINEDU',
                    regNo: 'ECSS/2021/0456',
                    class: 'SS 2 SCIENCE',
                    dob: '15th March, 2008',
                    age: '16 Years',
                    term: 'THIRD TERM',
                    session: '2023/2024 ACADEMIC SESSION',
                    house: 'BLUE HOUSE',
                    attendance: '96%',
                    conduct: 'EXCELLENT',
                    position: '5th out of 45 Students',
                    totalMarks: '786 out of 1000',
                    average: '78.6%',
                    classAverage: '65.2%',
                    promotion: 'PROMOTED TO SS 3 SCIENCE',
                    teacherComment: document.getElementById('teacherRemarks')?.value || 'Alex has shown remarkable improvement in his analytical skills this term. His performance in Mathematics is outstanding. He demonstrates excellent leadership qualities in group projects and shows initiative in class discussions.',
                    principalComment: document.getElementById('principalComment')?.value || 'I am pleased with Alex\'s performance this term. He has maintained excellent academic standards and participated actively in school activities. His attendance record is commendable.',
                    teacherName: document.getElementById('teacherName')?.value || 'Mr. T. O. Babalola',
                    principalName: document.getElementById('principalName')?.value || 'Mrs. A. B. Williams',
                    subjects: [
                        { name: 'Mathematics', ca1: 18, ca2: 19, exam: 52, total: 85, grade: 'A', remark: 'Excellent', position: '3rd' },
                        { name: 'English Language', ca1: 17, ca2: 16, exam: 45, total: 78, grade: 'A', remark: 'Very Good', position: '12th' },
                        { name: 'Physics', ca1: 15, ca2: 14, exam: 42, total: 71, grade: 'B', remark: 'Good', position: '8th' },
                        { name: 'Chemistry', ca1: 14, ca2: 13, exam: 40, total: 67, grade: 'B', remark: 'Good', position: '10th' },
                        { name: 'Biology', ca1: 15, ca2: 14, exam: 43, total: 72, grade: 'B', remark: 'Good', position: '6th' },
                        { name: 'Further Mathematics', ca1: 17, ca2: 18, exam: 46, total: 81, grade: 'A', remark: 'Excellent', position: '5th' },
                        { name: 'French', ca1: 12, ca2: 11, exam: 33, total: 56, grade: 'C', remark: 'Average', position: '25th' },
                        { name: 'Computer Studies', ca1: 16, ca2: 17, exam: 47, total: 80, grade: 'A', remark: 'Excellent', position: '4th' }
                    ]
                },
                'sarah': {
                    name: 'BABATUNDE FATIMA',
                    regNo: 'ECSS/2021/0457',
                    class: 'SS 2 SCIENCE',
                    dob: '22nd August, 2007',
                    age: '17 Years',
                    term: 'THIRD TERM',
                    session: '2023/2024 ACADEMIC SESSION',
                    house: 'GREEN HOUSE',
                    attendance: '92%',
                    conduct: 'VERY GOOD',
                    position: '12th out of 45 Students',
                    totalMarks: '782 out of 1000',
                    average: '78.2%',
                    classAverage: '65.2%',
                    promotion: 'PROMOTED TO SS 3 SCIENCE',
                    teacherComment: document.getElementById('teacherRemarks')?.value || 'Sarah is a creative and diligent student. Her performance in English Language and Creative Arts is excellent. She participates actively in school cultural activities. Needs to improve concentration in Mathematics and French classes.',
                    principalComment: document.getElementById('principalComment')?.value || 'Sarah has shown good progress this term. She maintains good academic standards and participates actively in school activities. Her attendance record is satisfactory.',
                    teacherName: document.getElementById('teacherName')?.value || 'Mr. T. O. Babalola',
                    principalName: document.getElementById('principalName')?.value || 'Mrs. A. B. Williams',
                    subjects: [
                        { name: 'Mathematics', ca1: 16, ca2: 15, exam: 48, total: 79, grade: 'B', remark: 'Good', position: '12th' },
                        { name: 'English Language', ca1: 18, ca2: 17, exam: 47, total: 82, grade: 'A', remark: 'Excellent', position: '5th' },
                        { name: 'Physics', ca1: 14, ca2: 13, exam: 41, total: 68, grade: 'B', remark: 'Good', position: '15th' },
                        { name: 'Chemistry', ca1: 15, ca2: 14, exam: 43, total: 72, grade: 'B', remark: 'Good', position: '9th' },
                        { name: 'Biology', ca1: 14, ca2: 13, exam: 41, total: 68, grade: 'B', remark: 'Good', position: '14th' },
                        { name: 'Further Mathematics', ca1: 13, ca2: 12, exam: 38, total: 63, grade: 'C', remark: 'Average', position: '22nd' },
                        { name: 'French', ca1: 10, ca2: 9, exam: 29, total: 48, grade: 'D', remark: 'Pass', position: '35th' },
                        { name: 'Computer Studies', ca1: 15, ca2: 14, exam: 42, total: 71, grade: 'B', remark: 'Good', position: '16th' }
                    ]
                },
                'generated': {
                    name: 'SAMPLE STUDENT',
                    regNo: 'ECSS/2021/0001',
                    class: 'SS 2 SCIENCE',
                    dob: '1st January, 2008',
                    age: '16 Years',
                    term: 'THIRD TERM',
                    session: '2023/2024 ACADEMIC SESSION',
                    house: 'RED HOUSE',
                    attendance: '95%',
                    conduct: 'VERY GOOD',
                    position: '10th out of 45 Students',
                    totalMarks: '750 out of 1000',
                    average: '75.0%',
                    classAverage: '65.2%',
                    promotion: 'PROMOTED TO SS 3 SCIENCE',
                    teacherComment: document.getElementById('teacherRemarks')?.value || 'The student has shown commendable performance this term. There is notable improvement in Mathematics and Sciences. Regular attendance and participation in class activities are appreciated. Continue to work hard in the coming terms.',
                    principalComment: document.getElementById('principalComment')?.value || 'A satisfactory performance. Keep up the good work and continue to strive for excellence. Your dedication to academic excellence is noted and appreciated.',
                    teacherName: document.getElementById('teacherName')?.value || 'Mr. T. O. Babalola',
                    principalName: document.getElementById('principalName')?.value || 'Mrs. A. B. Williams',
                    subjects: [
                        { name: 'Mathematics', ca1: 17, ca2: 16, exam: 47, total: 80, grade: 'A', remark: 'Excellent', position: '8th' },
                        { name: 'English Language', ca1: 16, ca2: 15, exam: 44, total: 75, grade: 'A', remark: 'Very Good', position: '15th' },
                        { name: 'Physics', ca1: 14, ca2: 13, exam: 41, total: 68, grade: 'B', remark: 'Good', position: '18th' },
                        { name: 'Chemistry', ca1: 13, ca2: 12, exam: 40, total: 65, grade: 'C', remark: 'Average', position: '20th' },
                        { name: 'Biology', ca1: 15, ca2: 14, exam: 43, total: 72, grade: 'B', remark: 'Good', position: '12th' },
                        { name: 'Further Mathematics', ca1: 12, ca2: 11, exam: 37, total: 60, grade: 'C', remark: 'Average', position: '25th' },
                        { name: 'French', ca1: 11, ca2: 10, exam: 32, total: 53, grade: 'C', remark: 'Average', position: '30th' },
                        { name: 'Computer Studies', ca1: 16, ca2: 15, exam: 45, total: 76, grade: 'A', remark: 'Very Good', position: '10th' }
                    ]
                }
            };
            
            const report = reportCards[student] || reportCards['generated'];
            
            // Calculate totals
            const totalCA1 = report.subjects.reduce((sum, subj) => sum + subj.ca1, 0);
            const totalCA2 = report.subjects.reduce((sum, subj) => sum + subj.ca2, 0);
            const totalExam = report.subjects.reduce((sum, subj) => sum + subj.exam, 0);
            const totalScore = report.subjects.reduce((sum, subj) => sum + subj.total, 0);
            
            document.getElementById('reportCardContent').innerHTML = `
                <div class="relative">
                    <!-- Watermark -->
                    <div class="watermark" style="top: 30%; left: 15%;">ELITE COMPREHENSIVE</div>
                    <div class="watermark" style="top: 60%; left: 60%;">SECONDARY SCHOOL</div>
                    
                    <!-- School Header -->
                    <div class="school-header text-center">
                        <div class="flex items-center justify-center gap-4 mb-4">
                            <!-- School Logo -->
                            <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center">
                                <div class="w-12 h-12 rounded-full border-4 border-amber-500 flex items-center justify-center">
                                    <span class="text-blue-900 font-bold text-lg">ECSS</span>
                                </div>
                            </div>
                            <div>
                                <h1 class="text-2xl font-bold">ELITE COMPREHENSIVE SECONDARY SCHOOL</h1>
                                <p class="text-sm opacity-90">KM 10, Lekki-Epe Expressway, Lagos</p>
                                <p class="text-xs opacity-80 school-motto">"Excellence in Education"</p>
                            </div>
                        </div>
                        <div class="official-stamp text-xs mt-2">OFFICIAL REPORT CARD</div>
                    </div>
                    
                    <!-- Report Card Content -->
                    <div class="p-8">
                        <!-- Term Header -->
                        <div class="text-center mb-8">
                            <h2 class="text-xl font-bold text-slate-900">${report.term} - ${report.session}</h2>
                            <div class="flex justify-center gap-8 mt-2 text-sm text-slate-600">
                                <span>Student's Copy</span>
                                <span>Issue Date: ${new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })}</span>
                            </div>
                        </div>
                        
                        <!-- Student Information -->
                        <div class="mb-8">
                            <h3 class="text-lg font-bold text-slate-900 mb-4 border-b pb-2">STUDENT INFORMATION</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <table class="w-full">
                                        <tbody>
                                            <tr>
                                                <td class="py-2 text-slate-600 w-40">Full Name:</td>
                                                <td class="py-2 font-bold">${report.name}</td>
                                            </tr>
                                            <tr>
                                                <td class="py-2 text-slate-600">Registration No:</td>
                                                <td class="py-2 font-bold text-blue-900">${report.regNo}</td>
                                            </tr>
                                            <tr>
                                                <td class="py-2 text-slate-600">Class:</td>
                                                <td class="py-2 font-bold">${report.class}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div>
                                    <table class="w-full">
                                        <tbody>
                                            <tr>
                                                <td class="py-2 text-slate-600 w-40">Date of Birth:</td>
                                                <td class="py-2 font-bold">${report.dob}</td>
                                            </tr>
                                            <tr>
                                                <td class="py-2 text-slate-600">Age:</td>
                                                <td class="py-2 font-bold">${report.age}</td>
                                            </tr>
                                            <tr>
                                                <td class="py-2 text-slate-600">House:</td>
                                                <td class="py-2 font-bold">${report.house}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Academic Performance Table -->
                        <div class="mb-8">
                            <h3 class="text-lg font-bold text-slate-900 mb-4 border-b pb-2">ACADEMIC PERFORMANCE</h3>
                            <div class="overflow-x-auto">
                                <table class="subject-table">
                                    <thead>
                                        <tr>
                                            <th>SUBJECTS</th>
                                            <th>1ST CA<br><span class="text-xs font-normal">(20)</span></th>
                                            <th>2ND CA<br><span class="text-xs font-normal">(20)</span></th>
                                            <th>EXAM<br><span class="text-xs font-normal">(60)</span></th>
                                            <th>TOTAL<br><span class="text-xs font-normal">(100)</span></th>
                                            <th>GRADE</th>
                                            <th>REMARK</th>
                                            <th>POSITION<br><span class="text-xs font-normal">in Class</span></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${report.subjects.map(subject => `
                                            <tr>
                                                <td class="subject-name">${subject.name}</td>
                                                <td>${subject.ca1}</td>
                                                <td>${subject.ca2}</td>
                                                <td>${subject.exam}</td>
                                                <td class="font-bold">${subject.total}</td>
                                                <td><div class="grade-box grade-${subject.grade.toLowerCase()}">${subject.grade}</div></td>
                                                <td>${subject.remark}</td>
                                                <td>${subject.position}</td>
                                            </tr>
                                        `).join('')}
                                        <tr class="total-row">
                                            <td class="subject-name">TOTAL / AVERAGE</td>
                                            <td>${(totalCA1/8).toFixed(1)}</td>
                                            <td>${(totalCA2/8).toFixed(1)}</td>
                                            <td>${(totalExam/8).toFixed(1)}</td>
                                            <td class="font-bold">${totalScore}</td>
                                            <td><div class="grade-box grade-${parseFloat(report.average) >= 75 ? 'a' : 'b'}">${parseFloat(report.average) >= 75 ? 'A' : 'B'}</div></td>
                                            <td>${parseFloat(report.average) >= 75 ? 'EXCELLENT' : 'GOOD'}</td>
                                            <td>${report.position.split(' ')[0]}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Summary Information -->
                        <div class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="p-4 border border-slate-300 rounded">
                                <h4 class="font-bold text-slate-900 mb-3">ACADEMIC SUMMARY</h4>
                                <table class="w-full">
                                    <tbody>
                                        <tr>
                                            <td class="py-2 text-slate-600">Total Marks Obtained:</td>
                                            <td class="py-2 font-bold">${report.totalMarks}</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Average Score:</td>
                                            <td class="py-2 font-bold">${report.average}</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Class Average:</td>
                                            <td class="py-2 font-bold">${report.classAverage}</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Position in Class:</td>
                                            <td class="py-2 font-bold">${report.position}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="p-4 border border-slate-300 rounded">
                                <h4 class="font-bold text-slate-900 mb-3">BEHAVIOURAL ASSESSMENT</h4>
                                <table class="w-full">
                                    <tbody>
                                        <tr>
                                            <td class="py-2 text-slate-600">Attendance:</td>
                                            <td class="py-2 font-bold">${report.attendance}</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Conduct:</td>
                                            <td class="py-2 font-bold">${report.conduct}</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Punctuality:</td>
                                            <td class="py-2 font-bold">Excellent</td>
                                        </tr>
                                        <tr>
                                            <td class="py-2 text-slate-600">Promotion Status:</td>
                                            <td class="py-2 font-bold text-emerald-700">${report.promotion}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Comments Section -->
                        <div class="mb-8">
                            <h3 class="text-lg font-bold text-slate-900 mb-4 border-b pb-2">COMMENTS</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="p-4 border border-slate-300 rounded">
                                    <h4 class="font-bold text-slate-900 mb-2">Class Teacher's Comment</h4>
                                    <p class="text-sm text-slate-700 mb-4">${report.teacherComment}</p>
                                    <div class="text-center">
                                        <p class="text-sm font-bold text-slate-700 mb-1">${report.teacherName}</p>
                                        <div class="signature-line"></div>
                                        <p class="text-xs text-slate-500 mt-1">Class Teacher</p>
                                    </div>
                                </div>
                                
                                <div class="p-4 border border-slate-300 rounded">
                                    <h4 class="font-bold text-slate-900 mb-2">Principal's Comment</h4>
                                    <p class="text-sm text-slate-700 mb-4">${report.principalComment}</p>
                                    <div class="text-center">
                                        <p class="text-sm font-bold text-slate-700 mb-1">${report.principalName}</p>
                                        <div class="signature-line"></div>
                                        <p class="text-xs text-slate-500 mt-1">Principal</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Next Term Information -->
                        <div class="mb-8 p-4 border border-amber-300 bg-amber-50 rounded">
                            <h4 class="font-bold text-slate-900 mb-3">NEXT TERM INFORMATION</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <p class="text-sm text-slate-600">Resumption Date:</p>
                                    <p class="font-bold text-slate-900">10th September, 2024</p>
                                </div>
                                <div>
                                    <p class="text-sm text-slate-600">School Fees Due:</p>
                                    <p class="font-bold text-slate-900">5th September, 2024</p>
                                </div>
                                <div>
                                    <p class="text-sm text-slate-600">Term Duration:</p>
                                    <p class="font-bold text-slate-900">12 Weeks</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Official Signatures -->
                        <div class="border-t border-slate-300 pt-8">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="text-center">
                                    <p class="text-sm font-bold text-slate-700 mb-2">Class Teacher's Signature</p>
                                    <div class="h-12 border-b border-slate-400 mx-8"></div>
                                </div>
                                <div class="text-center">
                                    <p class="text-sm font-bold text-slate-700 mb-2">Principal's Signature</p>
                                    <div class="h-12 border-b border-slate-400 mx-8"></div>
                                </div>
                                <div class="text-center">
                                    <p class="text-sm font-bold text-slate-700 mb-2">School Stamp</p>
                                    <div class="h-12 border-2 border-red-600 border-dashed mx-8 flex items-center justify-center">
                                        <span class="text-xs font-bold text-red-600">SCHOOL STAMP</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center mt-8">
                                <p class="text-xs text-slate-500">This is an official document. Any alterations render it invalid.</p>
                                <p class="text-xs font-bold text-slate-700 mt-2">Issued by Elite Comprehensive Secondary School, Lagos</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Print Actions -->
                    <div class="p-6 border-t border-slate-300">
                        <div class="flex justify-center gap-4">
                            <button onclick="printReportCard('${student}')" class="px-6 py-2 bg-blue-600 text-white font-medium rounded hover:bg-blue-700">
                                <i class="fas fa-print mr-2"></i>Print Report Card
                            </button>
                            <button onclick="downloadReportCard('${student}')" class="px-6 py-2 bg-white border border-slate-300 text-slate-700 font-medium rounded hover:bg-slate-50">
                                <i class="fas fa-download mr-2"></i>Download PDF
                            </button>
                            <button onclick="closeModal('reportCardModal')" class="px-6 py-2 bg-slate-100 text-slate-700 font-medium rounded hover:bg-slate-200">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            openModal('reportCardModal');
        }

        // Print Functions
        function printReportCard(student) {
            showToast(`Printing ${student}'s report card`, 'info');
            setTimeout(() => window.print(), 500);
        }

        function printPreview() {
            showToast('Opening print preview', 'info');
            setTimeout(() => window.print(), 500);
        }

        // Download Functions
        function downloadReportCard(student) {
            showToast(`Downloading ${student}'s official report card as PDF`, 'success');
            closeModal('reportCardModal');
        }

        function downloadReportPDF() {
            showToast('Preparing PDF download...', 'info');
            setTimeout(() => {
                showToast('PDF downloaded successfully!', 'success');
            }, 2000);
        }

        function exportAllReports() {
            showToast('Exporting all report cards as ZIP file', 'info');
            setTimeout(() => {
                showToast('All reports exported successfully!', 'success');
            }, 2000);
        }

        // Load Templates
        function loadTemplates() {
            showToast('Loading saved templates...', 'info');
        }

        function loadTemplate(templateName) {
            showToast(`"${templateName.replace('_', ' ')}" template loaded`, 'success');
        }

        // View Pending Reports
        function viewPendingReports() {
            showToast('Showing pending reports', 'info');
        }

        // View Statistics
        function viewStatistics() {
            showToast('Opening statistics dashboard', 'info');
        }

        // Change Term for Chart
        function changeTerm(term) {
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update chart data based on term
            showToast(`Showing ${term} data`, 'info');
        }

        // Toast Notification System
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                info: 'fas fa-info-circle',
                warning: 'fas fa-exclamation-triangle',
                error: 'fas fa-times-circle'
            };
            
            toast.innerHTML = `
                <i class="toast-icon ${icons[type]}"></i>
                <div class="toast-content">${message}</div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(toast);
            
            // Remove toast after 5 seconds
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.classList.add('toast-exit');
                    setTimeout(() => toast.remove(), 300);
                }
            }, 5000);
        }

        // Mobile Sidebar Toggle
        function mobileSidebarToggle() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar.classList.contains('-translate-x-full')) {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            }
        }

        // Toggle Notifications Dropdown
        function toggleNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            if (notificationsVisible) {
                dropdown.classList.add('hidden');
            } else {
                dropdown.classList.remove('hidden');
                // Close profile menu if open
                if (profileMenuVisible) {
                    document.getElementById('profileDropdown').classList.add('hidden');
                    profileMenuVisible = false;
                }
            }
            notificationsVisible = !notificationsVisible;
        }

        // Toggle Profile Menu
        function toggleProfileMenu() {
            const dropdown = document.getElementById('profileDropdown');
            if (profileMenuVisible) {
                dropdown.classList.add('hidden');
            } else {
                dropdown.classList.remove('hidden');
                // Close notifications if open
                if (notificationsVisible) {
                    document.getElementById('notificationDropdown').classList.add('hidden');
                    notificationsVisible = false;
                }
            }
            profileMenuVisible = !profileMenuVisible;
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const notifications = document.getElementById('notificationDropdown');
            const profile = document.getElementById('profileDropdown');
            const notificationBtn = event.target.closest('.notification-bell');
            const profileBtn = event.target.closest('.relative button');
            
            if (!notificationBtn && notifications && !notifications.contains(event.target)) {
                notifications.classList.add('hidden');
                notificationsVisible = false;
            }
            
            if (!profileBtn && profile && !profile.contains(event.target)) {
                profile.classList.add('hidden');
                profileMenuVisible = false;
            }
        });

        // Sample functions for table actions
        function downloadReport(id) {
            showToast('Downloading report...', 'info');
            setTimeout(() => showToast('Report downloaded successfully!', 'success'), 1000);
        }

        function printReport(id) {
            showToast('Opening print dialog...', 'info');
            setTimeout(() => window.print(), 500);
        }

        function editReport(id) {
            showToast('Opening report editor...', 'info');
            openReportGenerator();
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Only trigger when not in input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {
                return;
            }
            
            // Ctrl/Cmd + N: New report
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                openReportGenerator();
            }
            
            // Ctrl/Cmd + P: Print
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                printPreview();
            }
            
            // Ctrl/Cmd + E: Export all
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                exportAllReports();
            }
        });
    </script>
</body>
</html>