<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0"
    />
    <title>Fee Management | AcademixSuite School Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap");

      :root {
        --school-primary: #4f46e5;
        --school-secondary: #10b981;
        --school-surface: #ffffff;
        --school-bg: #f8fafc;
        --fee-paid: #10b981;
        --fee-pending: #f59e0b;
        --fee-overdue: #ef4444;
        --fee-partial: #3b82f6;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--school-bg);
        color: #1e293b;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Glassmorphism effects */
      .glass-header {
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.3);
      }

      .glass-card {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(226, 232, 240, 0.5);
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);
      }

      /* Toast Notification Styles */
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        gap: 10px;
        max-width: 400px;
      }

      .toast {
        padding: 16px 20px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        animation: slideIn 0.3s ease forwards;
        opacity: 0;
        transform: translateX(100px);
        transition: opacity 0.3s, transform 0.3s;
      }

      .toast-success {
        background: linear-gradient(135deg, #10b981, #34d399);
        color: white;
        border-left: 4px solid #059669;
      }

      .toast-info {
        background: linear-gradient(135deg, #4f46e5, #7c73e9);
        color: white;
        border-left: 4px solid #3730a3;
      }

      .toast-warning {
        background: linear-gradient(135deg, #f59e0b, #fbbf24);
        color: white;
        border-left: 4px solid #d97706;
      }

      .toast-error {
        background: linear-gradient(135deg, #ef4444, #f87171);
        color: white;
        border-left: 4px solid #dc2626;
      }

      @keyframes slideIn {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes fadeOut {
        to {
          opacity: 0;
          transform: translateX(100px);
        }
      }

      .toast-exit {
        animation: fadeOut 0.3s ease forwards;
      }

      .toast-icon {
        font-size: 18px;
        flex-shrink: 0;
      }

      .toast-content {
        flex: 1;
      }

      .toast-close {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.8);
        font-size: 14px;
        cursor: pointer;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background-color 0.2s;
      }

      .toast-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* Sidebar styling */
      .sidebar-link {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        border-left: 3px solid transparent;
        position: relative;
      }

      .sidebar-link:hover {
        background: linear-gradient(
          90deg,
          rgba(79, 70, 229, 0.05) 0%,
          rgba(79, 70, 229, 0.02) 100%
        );
        color: var(--school-primary);
        border-left-color: rgba(79, 70, 229, 0.3);
      }

      .active-link {
        background: linear-gradient(
          90deg,
          rgba(79, 70, 229, 0.1) 0%,
          rgba(79, 70, 229, 0.05) 100%
        );
        color: var(--school-primary);
        border-left-color: var(--school-primary);
        font-weight: 700;
      }

      .active-link::before {
        content: "";
        position: absolute;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 4px;
        height: 60%;
        background: var(--school-primary);
        border-radius: 4px 0 0 4px;
      }

      /* Custom scrollbar */
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }

      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      /* Animation for cards */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out forwards;
      }

      /* Fee Status Badges */
      .fee-status {
        display: inline-flex;
        align-items: center;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .status-paid {
        background-color: #dcfce7;
        color: #166534;
        border: 1px solid #bbf7d0;
      }

      .status-pending {
        background-color: #fef3c7;
        color: #92400e;
        border: 1px solid #fde68a;
      }

      .status-overdue {
        background-color: #fee2e2;
        color: #991b1b;
        border: 1px solid #fecaca;
      }

      .status-partial {
        background-color: #dbeafe;
        color: #1e40af;
        border: 1px solid #bfdbfe;
      }

      /* Fee Amount Styles */
      .fee-amount {
        font-weight: 800;
        font-size: 18px;
        color: #1e293b;
      }

      .fee-amount.paid {
        color: #10b981;
      }

      .fee-amount.pending {
        color: #f59e0b;
      }

      .fee-amount.overdue {
        color: #ef4444;
      }

      .fee-amount.partial {
        color: #3b82f6;
      }

      /* Tab styling */
      .tab-button {
        padding: 12px 24px;
        font-size: 14px;
        font-weight: 600;
        color: #64748b;
        background: transparent;
        border: none;
        border-bottom: 3px solid transparent;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .tab-button:hover {
        color: #4f46e5;
      }

      .tab-button.active {
        color: #4f46e5;
        border-bottom-color: #4f46e5;
        background: linear-gradient(
          to top,
          rgba(79, 70, 229, 0.05),
          transparent
        );
      }

      /* Metric Cards */
      .metric-card {
        position: relative;
        overflow: hidden;
      }

      .metric-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--metric-color), transparent);
      }

      .metric-primary {
        --metric-color: #4f46e5;
      }

      .metric-success {
        --metric-color: #10b981;
      }

      .metric-warning {
        --metric-color: #f59e0b;
      }

      .metric-danger {
        --metric-color: #ef4444;
      }

      /* Chart Containers */
      .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
      }

      /* Action Buttons */
      .action-btn {
        padding: 8px 16px;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.2s ease;
        cursor: pointer;
        border: none;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .action-btn-primary {
        background: linear-gradient(135deg, #4f46e5, #7c73e9);
        color: white;
      }

      .action-btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
      }

      .action-btn-secondary {
        background: white;
        color: #4f46e5;
        border: 1px solid #e2e8f0;
      }

      .action-btn-secondary:hover {
        background: #f8fafc;
        border-color: #4f46e5;
      }

      .action-btn-success {
        background: linear-gradient(135deg, #10b981, #34d399);
        color: white;
      }

      .action-btn-success:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
      }

      .action-btn-danger {
        background: linear-gradient(135deg, #ef4444, #f87171);
        color: white;
      }

      .action-btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
      }

      /* Search and Filter */
      .search-box {
        position: relative;
        width: 100%;
      }

      .search-input {
        width: 100%;
        padding: 12px 16px 12px 44px;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        transition: all 0.2s;
        background: white;
      }

      .search-input:focus {
        outline: none;
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: #94a3b8;
      }

      /* Filter Chips */
      .filter-chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        background: #f1f5f9;
        border: 1px solid #e2e8f0;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        color: #475569;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .filter-chip:hover {
        background: #e2e8f0;
      }

      .filter-chip.active {
        background: #4f46e5;
        color: white;
        border-color: #4f46e5;
      }

      /* Pagination */
      .pagination-btn {
        padding: 8px 12px;
        background: white;
        border: 1px solid #e2e8f0;
        color: #64748b;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .pagination-btn:hover {
        background: #f8fafc;
        border-color: #4f46e5;
        color: #4f46e5;
      }

      .pagination-btn.active {
        background: #4f46e5;
        color: white;
        border-color: #4f46e5;
      }

      .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* Table Styles */
      .table-container {
        overflow-x: auto;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
      }

      .data-table th {
        background: #f8fafc;
        padding: 16px;
        text-align: left;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #64748b;
        border-bottom: 2px solid #e2e8f0;
      }

      .data-table td {
        padding: 16px;
        border-bottom: 1px solid #e2e8f0;
        vertical-align: middle;
      }

      .data-table tr:hover {
        background: #f8fafc;
      }

      .data-table tr:last-child td {
        border-bottom: none;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 20px;
      }

      .modal-content {
        background: white;
        border-radius: 16px;
        max-width: 800px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
      }

      /* Form Styles */
      .form-label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        font-weight: 600;
        color: #1e293b;
      }

      .form-input {
        width: 100%;
        padding: 12px;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        transition: all 0.2s;
        background: white;
      }

      .form-input:focus {
        outline: none;
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      .form-select {
        width: 100%;
        padding: 12px;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        background: white;
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 12px center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
      }

      /* Fee Progress */
      .fee-progress {
        height: 8px;
        border-radius: 4px;
        background: #f1f5f9;
        overflow: hidden;
        position: relative;
      }

      .fee-progress-fill {
        height: 100%;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .progress-paid {
        background: linear-gradient(90deg, #10b981, #34d399);
      }
      .progress-pending {
        background: linear-gradient(90deg, #f59e0b, #fbbf24);
      }
      .progress-overdue {
        background: linear-gradient(90deg, #ef4444, #f87171);
      }
      .progress-partial {
        background: linear-gradient(90deg, #3b82f6, #60a5fa);
      }

      /* Fee Breakdown */
      .fee-breakdown {
        border-radius: 12px;
        padding: 20px;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
      }

      .breakdown-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid #e2e8f0;
      }

      .breakdown-item:last-child {
        border-bottom: none;
        font-weight: 800;
        color: #1e293b;
      }

      /* Payment Timeline */
      .payment-timeline {
        position: relative;
        padding-left: 20px;
      }

      .payment-timeline::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #e2e8f0;
      }

      .timeline-item {
        position: relative;
        padding-bottom: 20px;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        left: -24px;
        top: 4px;
        width: 10px;
        height: 10px;
        border-radius: 50%;
      }

      .timeline-paid::before {
        background: #10b981;
      }
      .timeline-pending::before {
        background: #f59e0b;
      }
      .timeline-overdue::before {
        background: #ef4444;
      }

      /* Invoice Card */
      .invoice-card {
        border-radius: 12px;
        padding: 20px;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 2px solid transparent;
      }

      .invoice-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        border-color: rgba(79, 70, 229, 0.2);
      }

      .invoice-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
      }

      .invoice-paid::before {
        background: linear-gradient(90deg, #10b981, #34d399);
      }
      .invoice-pending::before {
        background: linear-gradient(90deg, #f59e0b, #fbbf24);
      }
      .invoice-overdue::before {
        background: linear-gradient(90deg, #ef4444, #f87171);
      }
      .invoice-partial::before {
        background: linear-gradient(90deg, #3b82f6, #60a5fa);
      }

      /* Payment Methods */
      .payment-method {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px;
        background: white;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .payment-method:hover {
        border-color: #4f46e5;
        background: #f8fafc;
      }

      .payment-method.selected {
        border-color: #4f46e5;
        background: linear-gradient(
          to right,
          rgba(79, 70, 229, 0.05),
          transparent
        );
      }

      /* Receipt Styles */
      .receipt-container {
        background: white;
        border-radius: 12px;
        padding: 32px;
        border: 2px solid #e2e8f0;
        max-width: 600px;
        margin: 0 auto;
      }

      .receipt-header {
        text-align: center;
        border-bottom: 2px solid #e2e8f0;
        padding-bottom: 24px;
        margin-bottom: 24px;
      }

      .receipt-item {
        display: flex;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid #f1f5f9;
      }

      .receipt-total {
        display: flex;
        justify-content: space-between;
        padding: 20px 0;
        font-weight: 800;
        font-size: 18px;
        color: #1e293b;
        border-top: 2px solid #e2e8f0;
        margin-top: 20px;
      }

      /* Mobile optimizations */
      @media (max-width: 768px) {
        .glass-header {
          backdrop-filter: none;
          -webkit-backdrop-filter: none;
          background: white;
        }

        .toast-container {
          left: 20px;
          right: 20px;
          max-width: none;
        }

        .chart-container {
          height: 250px !important;
        }

        .invoice-card {
          padding: 16px;
        }

        .receipt-container {
          padding: 20px;
        }
      }

      /* Print Styles */
      @media print {
        .no-print {
          display: none !important;
        }

        body {
          background: white;
        }

        .glass-card {
          box-shadow: none;
          border: 1px solid #e2e8f0;
        }

        .receipt-container {
          border: none;
          box-shadow: none;
        }
      }

      /* Loading Animation */
      .loader {
        width: 48px;
        height: 48px;
        border: 4px solid #f1f5f9;
        border-top-color: #4f46e5;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Due Date Indicator */
      .due-date {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 11px;
        font-weight: 600;
      }

      .due-soon {
        background: #fef3c7;
        color: #92400e;
        border: 1px solid #fde68a;
      }

      .due-today {
        background: #fee2e2;
        color: #991b1b;
        border: 1px solid #fecaca;
      }

      .due-future {
        background: #dcfce7;
        color: #166534;
        border: 1px solid #bbf7d0;
      }

      /* Fee Summary Card */
      .summary-card {
        border-radius: 12px;
        padding: 24px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .summary-value {
        font-size: 32px;
        font-weight: 900;
        color: #1e293b;
        margin: 12px 0;
      }

      .summary-label {
        font-size: 14px;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 700;
      }

      /* Discount Badge */
      .discount-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        background: #dcfce7;
        color: #166534;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 700;
      }

      /* Fee Installment Plan */
      .installment-plan {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
      }

      .installment-card {
        background: white;
        border-radius: 12px;
        padding: 16px;
        border: 2px solid #e2e8f0;
        text-align: center;
        transition: all 0.2s ease;
      }

      .installment-card:hover {
        border-color: #4f46e5;
        transform: translateY(-2px);
      }

      .installment-card.paid {
        border-color: #10b981;
        background: #f0fdf4;
      }

      .installment-card.pending {
        border-color: #f59e0b;
        background: #fffbeb;
      }

      .installment-card.overdue {
        border-color: #ef4444;
        background: #fef2f2;
      }

      /* Payment Status Legend */
      .status-legend {
        display: flex;
        align-items: center;
        gap: 16px;
        flex-wrap: wrap;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        font-weight: 600;
        color: #475569;
      }

      .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 3px;
      }

      .legend-paid {
        background: #10b981;
      }
      .legend-pending {
        background: #f59e0b;
      }
      .legend-overdue {
        background: #ef4444;
      }
      .legend-partial {
        background: #3b82f6;
      }

      /* Collection Calendar */
      .collection-calendar {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
      }

      .calendar-day {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      }

      .calendar-day.collected {
        background: #dcfce7;
        color: #166534;
        border: 2px solid #bbf7d0;
      }

      .calendar-day.pending {
        background: #fef3c7;
        color: #92400e;
        border: 2px solid #fde68a;
      }

      .calendar-day.overdue {
        background: #fee2e2;
        color: #991b1b;
        border: 2px solid #fecaca;
      }

      .calendar-day.today {
        background: #4f46e5;
        color: white;
      }

      .calendar-day:hover {
        transform: scale(1.1);
      }
    </style>
  </head>
  <body class="antialiased selection:bg-indigo-100 selection:text-indigo-900">
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Mobile Sidebar Overlay -->
    <div
      id="sidebarOverlay"
      class="fixed inset-0 bg-black bg-opacity-50 z-[99] lg:hidden hidden"
      onclick="mobileSidebarToggle()"
    ></div>

    <!-- Record Payment Modal -->
    <div
      id="recordPaymentModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden"
    >
      <div class="modal-content">
        <div class="p-8">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-black text-slate-900">
              Record New Payment
            </h3>
            <button
              onclick="closeModal('recordPaymentModal')"
              class="text-slate-400 hover:text-slate-600"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label class="form-label">Student</label>
              <select
                id="paymentStudent"
                class="form-select"
                required
                onchange="loadStudentFeeDetails()"
              >
                <option value="">Select Student</option>
                <option value="1">John Doe (Grade 10A)</option>
                <option value="2">Sarah Johnson (Grade 11B)</option>
                <option value="3">Michael Brown (Grade 9C)</option>
                <option value="4">Emma Wilson (Grade 12A)</option>
                <option value="5">David Lee (Grade 10B)</option>
              </select>
            </div>

            <div>
              <label class="form-label">Fee Type</label>
              <select id="paymentFeeType" class="form-select" required>
                <option value="">Select Fee Type</option>
                <option value="tuition">Tuition Fee</option>
                <option value="admission">Admission Fee</option>
                <option value="exam">Examination Fee</option>
                <option value="transport">Transport Fee</option>
                <option value="hostel">Hostel Fee</option>
                <option value="library">Library Fee</option>
                <option value="lab">Lab Fee</option>
                <option value="sports">Sports Fee</option>
              </select>
            </div>

            <div>
              <label class="form-label">Academic Year</label>
              <select id="paymentAcademicYear" class="form-select" required>
                <option value="2024-2025">2024-2025</option>
                <option value="2023-2024">2023-2024</option>
                <option value="2022-2023">2022-2023</option>
              </select>
            </div>

            <div>
              <label class="form-label">Term</label>
              <select id="paymentTerm" class="form-select" required>
                <option value="term1">Term 1</option>
                <option value="term2">Term 2</option>
                <option value="term3">Term 3</option>
                <option value="annual">Annual</option>
              </select>
            </div>

            <div>
              <label class="form-label">Amount Due</label>
              <div class="flex items-center gap-2">
                <span class="text-2xl font-black text-slate-900">$</span>
                <input
                  type="number"
                  id="paymentAmountDue"
                  class="form-input"
                  placeholder="0.00"
                  readonly
                />
              </div>
            </div>

            <div>
              <label class="form-label">Amount Paid</label>
              <div class="flex items-center gap-2">
                <span class="text-2xl font-black text-slate-900">$</span>
                <input
                  type="number"
                  id="paymentAmount"
                  class="form-input"
                  placeholder="0.00"
                  required
                  min="0"
                />
              </div>
            </div>

            <div>
              <label class="form-label">Payment Date</label>
              <input
                type="date"
                id="paymentDate"
                class="form-input"
                value="2024-12-04"
                required
              />
            </div>

            <div>
              <label class="form-label">Payment Method</label>
              <select id="paymentMethod" class="form-select" required>
                <option value="cash">Cash</option>
                <option value="bank_transfer">Bank Transfer</option>
                <option value="check">Check</option>
                <option value="credit_card">Credit Card</option>
                <option value="debit_card">Debit Card</option>
                <option value="online">Online Payment</option>
                <option value="mobile">Mobile Payment</option>
              </select>
            </div>

            <div class="md:col-span-2">
              <label class="form-label">Transaction Reference</label>
              <input
                type="text"
                id="paymentReference"
                class="form-input"
                placeholder="Enter transaction reference number"
              />
            </div>

            <div class="md:col-span-2">
              <label class="form-label">Notes</label>
              <textarea
                id="paymentNotes"
                class="form-input h-24"
                placeholder="Add payment notes or remarks..."
              ></textarea>
            </div>
          </div>

          <div class="p-4 bg-blue-50 border border-blue-200 rounded-xl mb-6">
            <div class="flex items-center gap-2">
              <i class="fas fa-info-circle text-blue-600"></i>
              <p class="text-sm text-blue-700">
                Receipt will be generated automatically. You can print or email
                it to the parent.
              </p>
            </div>
          </div>

          <div class="flex gap-3">
            <button
              onclick="closeModal('recordPaymentModal')"
              class="flex-1 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition"
            >
              Cancel
            </button>
            <button
              onclick="savePayment()"
              class="flex-1 py-3 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-emerald-200"
            >
              Record Payment
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Generate Invoice Modal -->
    <div
      id="generateInvoiceModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden"
    >
      <div class="modal-content">
        <div class="p-8">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-black text-slate-900">
              Generate Fee Invoice
            </h3>
            <button
              onclick="closeModal('generateInvoiceModal')"
              class="text-slate-400 hover:text-slate-600"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label class="form-label">Invoice Type</label>
              <select id="invoiceType" class="form-select" required>
                <option value="single">Single Student Invoice</option>
                <option value="bulk">Bulk Invoices</option>
                <option value="class">Class-wise Invoices</option>
                <option value="grade">Grade-wise Invoices</option>
              </select>
            </div>

            <div>
              <label class="form-label">Academic Year</label>
              <select id="invoiceAcademicYear" class="form-select" required>
                <option value="2024-2025" selected>2024-2025</option>
                <option value="2023-2024">2023-2024</option>
              </select>
            </div>

            <div>
              <label class="form-label">Term</label>
              <select id="invoiceTerm" class="form-select" required>
                <option value="term1">Term 1</option>
                <option value="term2" selected>Term 2</option>
                <option value="term3">Term 3</option>
                <option value="annual">Annual</option>
              </select>
            </div>

            <div>
              <label class="form-label">Due Date</label>
              <input
                type="date"
                id="invoiceDueDate"
                class="form-input"
                value="2024-12-31"
                required
              />
            </div>

            <div id="singleStudentSection">
              <label class="form-label">Select Student</label>
              <select id="invoiceStudent" class="form-select">
                <option value="">Select Student</option>
                <option value="1">John Doe (Grade 10A)</option>
                <option value="2">Sarah Johnson (Grade 11B)</option>
                <option value="3">Michael Brown (Grade 9C)</option>
              </select>
            </div>

            <div id="bulkSection" class="hidden">
              <label class="form-label">Select Grade/Class</label>
              <select id="invoiceClass" class="form-select">
                <option value="">Select Class</option>
                <option value="10">Grade 10</option>
                <option value="11">Grade 11</option>
                <option value="12">Grade 12</option>
              </select>
            </div>
          </div>

          <div class="fee-breakdown mb-6">
            <h4 class="text-lg font-black text-slate-900 mb-4">
              Fee Breakdown
            </h4>
            <div class="breakdown-item">
              <span>Tuition Fee</span>
              <span class="font-bold">$1,200.00</span>
            </div>
            <div class="breakdown-item">
              <span>Examination Fee</span>
              <span class="font-bold">$150.00</span>
            </div>
            <div class="breakdown-item">
              <span>Library Fee</span>
              <span class="font-bold">$50.00</span>
            </div>
            <div class="breakdown-item">
              <span>Sports Fee</span>
              <span class="font-bold">$75.00</span>
            </div>
            <div class="breakdown-item">
              <span>Late Fee (if applicable)</span>
              <span class="font-bold">$25.00</span>
            </div>
            <div class="breakdown-item">
              <span class="text-lg font-black">Total Amount</span>
              <span class="text-lg font-black">$1,500.00</span>
            </div>
          </div>

          <div class="flex gap-3">
            <button
              onclick="closeModal('generateInvoiceModal')"
              class="flex-1 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition"
            >
              Cancel
            </button>
            <button
              onclick="generateInvoice()"
              class="flex-1 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200"
            >
              Generate Invoice
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- View Receipt Modal -->
    <div
      id="viewReceiptModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden"
    >
      <div class="modal-content" style="max-width: 600px">
        <div class="p-8">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-black text-slate-900">Payment Receipt</h3>
            <div class="flex items-center gap-3">
              <button
                onclick="printReceipt()"
                class="p-2 text-slate-600 hover:text-slate-800"
              >
                <i class="fas fa-print"></i>
              </button>
              <button
                onclick="emailReceipt()"
                class="p-2 text-slate-600 hover:text-slate-800"
              >
                <i class="fas fa-envelope"></i>
              </button>
              <button
                onclick="closeModal('viewReceiptModal')"
                class="text-slate-400 hover:text-slate-600"
              >
                <i class="fas fa-times text-xl"></i>
              </button>
            </div>
          </div>

          <div id="receiptContent">
            <!-- Receipt will be loaded dynamically -->
          </div>
        </div>
      </div>
    </div>

    <!-- Send Reminders Modal -->
    <div
      id="sendRemindersModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1000] hidden"
    >
      <div class="modal-content" style="max-width: 600px">
        <div class="p-8">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-black text-slate-900">
              Send Fee Reminders
            </h3>
            <button
              onclick="closeModal('sendRemindersModal')"
              class="text-slate-400 hover:text-slate-600"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>

          <div class="space-y-6">
            <div>
              <label class="form-label">Reminder Type</label>
              <select id="reminderType" class="form-select">
                <option value="overdue">Overdue Fees</option>
                <option value="upcoming">Upcoming Due Dates</option>
                <option value="partial">Partial Payments</option>
                <option value="all">All Pending Fees</option>
              </select>
            </div>

            <div>
              <label class="form-label">Communication Method</label>
              <div class="grid grid-cols-2 gap-3">
                <label
                  class="payment-method"
                  onclick="selectReminderMethod('email')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center"
                  >
                    <i class="fas fa-envelope text-blue-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">Email</p>
                    <p class="text-sm text-slate-500">Send email reminders</p>
                  </div>
                  <input
                    type="radio"
                    name="reminderMethod"
                    value="email"
                    class="hidden"
                    checked
                  />
                </label>
                <label
                  class="payment-method"
                  onclick="selectReminderMethod('sms')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center"
                  >
                    <i class="fas fa-sms text-green-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">SMS</p>
                    <p class="text-sm text-slate-500">Send text messages</p>
                  </div>
                  <input
                    type="radio"
                    name="reminderMethod"
                    value="sms"
                    class="hidden"
                  />
                </label>
              </div>
            </div>

            <div>
              <label class="form-label">Custom Message</label>
              <textarea
                id="reminderMessage"
                class="form-input h-32"
                placeholder="Customize the reminder message..."
              >
Dear Parent, This is a reminder that the school fees for Term 2 are due. Please make the payment at your earliest convenience to avoid late fees.</textarea
              >
            </div>

            <div class="p-4 bg-amber-50 border border-amber-200 rounded-xl">
              <div class="flex items-center gap-2 mb-1">
                <i class="fas fa-exclamation-triangle text-amber-600"></i>
                <span class="text-sm font-bold text-amber-700"
                  >Reminder Status</span
                >
              </div>
              <p class="text-xs text-amber-600">
                This will send reminders to
                <span id="reminderCount">24</span> parents with pending fees.
              </p>
            </div>
          </div>

          <div class="flex gap-3 mt-8 pt-6 border-t border-slate-100">
            <button
              onclick="closeModal('sendRemindersModal')"
              class="flex-1 py-3 border border-slate-300 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition"
            >
              Cancel
            </button>
            <button
              onclick="sendReminders()"
              class="flex-1 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200"
            >
              Send Reminders
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bulk Edit Panel -->
    <div class="bulk-edit-panel" id="bulkEditPanel">
      <div class="max-w-7xl mx-auto">
        <div
          class="flex flex-col md:flex-row md:items-center justify-between gap-4"
        >
          <div>
            <p class="font-bold text-slate-900" id="bulkEditCount">
              0 fees selected
            </p>
            <p class="text-sm text-slate-500">
              Apply actions to all selected fee records
            </p>
          </div>

          <div class="flex items-center gap-3">
            <div class="flex items-center gap-2">
              <button
                onclick="applyBulkDiscount()"
                class="px-3 py-2 bg-emerald-100 text-emerald-700 font-bold rounded-lg hover:bg-emerald-200 transition text-sm"
              >
                <i class="fas fa-percentage"></i> Apply Discount
              </button>
              <button
                onclick="extendBulkDueDate()"
                class="px-3 py-2 bg-blue-100 text-blue-700 font-bold rounded-lg hover:bg-blue-200 transition text-sm"
              >
                <i class="fas fa-calendar-plus"></i> Extend Due Date
              </button>
              <button
                onclick="sendBulkReminders()"
                class="px-3 py-2 bg-amber-100 text-amber-700 font-bold rounded-lg hover:bg-amber-200 transition text-sm"
              >
                <i class="fas fa-bell"></i> Send Reminders
              </button>
              <button
                onclick="exportBulkData()"
                class="px-3 py-2 bg-purple-100 text-purple-700 font-bold rounded-lg hover:bg-purple-200 transition text-sm"
              >
                <i class="fas fa-download"></i> Export
              </button>
            </div>

            <button
              onclick="closeBulkEdit()"
              class="action-btn action-btn-danger"
            >
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="flex h-screen overflow-hidden">
      <aside
        id="sidebar"
        class="fixed inset-y-0 left-0 w-64 bg-white border-r border-slate-200 z-[100] lg:relative lg:translate-x-0 -translate-x-full transition-transform duration-300 flex flex-col shadow-xl lg:shadow-none"
      >
        <!-- School Header -->
        <div class="h-20 flex items-center px-6 border-b border-slate-100">
          <div class="flex items-center gap-3">
            <div class="relative">
              <div
                class="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-600 to-purple-600 flex items-center justify-center shadow-lg shadow-indigo-100"
              >
                <i class="fas fa-school text-white text-lg"></i>
              </div>
              <div
                class="absolute -bottom-1 -right-1 w-4 h-4 bg-emerald-500 border-2 border-white rounded-full"
              ></div>
            </div>
            <div>
              <span class="text-xl font-black tracking-tight text-slate-900"
                >Greenwood High</span
              >
              <p
                class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5"
              >
                SCHOOL ADMIN
              </p>
            </div>
          </div>
        </div>

        <!-- School Quick Info -->
        <div class="p-6 border-b border-slate-100">
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <span class="text-sm font-medium text-slate-600"
                >Fees Collected:</span
              >
              <span class="text-sm font-black text-emerald-600">$124,580</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm font-medium text-slate-600">Pending:</span>
              <span class="text-sm font-bold text-amber-600">$24,320</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-sm font-medium text-slate-600">Overdue:</span>
              <span class="text-sm font-bold text-red-600">$8,450</span>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="flex-1 overflow-y-auto py-6 space-y-8 custom-scrollbar">
          <div>
            <p
              class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3"
            >
              Dashboard
            </p>
            <nav class="space-y-1">
              <a
                href="school-dashboard.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-chart-pie"></i>
                </div>
                <span>Overview</span>
              </a>
              <a
                href="school-announcements.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-bullhorn"></i>
                </div>
                <span>Announcements</span>
              </a>
            </nav>
          </div>

          <div>
            <p
              class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3"
            >
              Student Management
            </p>
            <nav class="space-y-1">
              <a
                href="school-students.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-user-graduate"></i>
                </div>
                <span>Students Directory</span>
              </a>
              <a
                href="school-attendance.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-calendar-check"></i>
                </div>
                <span>Attendance</span>
              </a>
              <a
                href="school-grades.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-chart-bar"></i>
                </div>
                <span>Grades & Reports</span>
              </a>
            </nav>
          </div>

          <div>
            <p
              class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3"
            >
              Staff Management
            </p>
            <nav class="space-y-1">
              <a
                href="school-teachers.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <span>Teachers</span>
              </a>
              <a
                href="school-schedule.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-calendar-alt"></i>
                </div>
                <span>Timetable</span>
              </a>
            </nav>
          </div>

          <div>
            <p
              class="px-6 text-[11px] font-black text-slate-400 uppercase tracking-[0.15em] mb-3"
            >
              School Operations
            </p>
            <nav class="space-y-1">
              <a
                href="school-fees.html"
                class="sidebar-link active-link flex items-center gap-3 px-6 py-3 text-sm font-semibold"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-receipt"></i>
                </div>
                <span>Fee Management</span>
              </a>
              <a
                href="school-settings.html"
                class="sidebar-link flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-600"
              >
                <div class="w-5 h-5 flex items-center justify-center">
                  <i class="fas fa-cog"></i>
                </div>
                <span>School Settings</span>
              </a>
            </nav>
          </div>
        </div>

        <!-- User Profile -->
        <div class="p-6 border-t border-slate-100">
          <div
            class="flex items-center gap-3 p-2 group cursor-pointer hover:bg-slate-50 rounded-xl transition"
          >
            <div class="relative">
              <img
                src="https://ui-avatars.com/api/?name=Principal+Smith&background=4f46e5&color=fff&bold=true&size=128"
                class="w-10 h-10 rounded-xl shadow-sm"
              />
              <div
                class="absolute -bottom-1 -right-1 w-3.5 h-3.5 bg-emerald-500 border-2 border-white rounded-full"
              ></div>
            </div>
            <div class="overflow-hidden flex-1">
              <p class="text-[13px] font-black text-slate-900 truncate">
                Principal Smith
              </p>
              <p
                class="text-[10px] font-black text-indigo-600 uppercase tracking-wider italic"
              >
                School_Admin
              </p>
            </div>
          </div>
        </div>
      </aside>

      <main class="flex-1 flex flex-col min-w-0 overflow-hidden">
        <!-- Header -->
        <header
          class="h-20 glass-header px-6 lg:px-8 flex items-center justify-between shrink-0 z-40"
        >
          <div class="flex items-center gap-3">
            <button
              onclick="mobileSidebarToggle()"
              class="lg:hidden text-slate-600 p-2 hover:bg-slate-100 rounded-lg transition"
            >
              <i class="fas fa-bars-staggered"></i>
            </button>
            <div class="flex items-center gap-3">
              <h1 class="text-lg font-black text-slate-900 tracking-tight">
                Fee Management
              </h1>
              <div class="hidden lg:flex items-center gap-2">
                <div class="w-2 h-2 bg-emerald-500 rounded-full"></div>
                <span
                  class="text-xs font-black text-emerald-600 uppercase tracking-widest"
                  >Term 2, 2024-2025</span
                >
              </div>
            </div>
          </div>

          <div class="flex items-center gap-4">
            <!-- Quick Stats -->
            <div
              class="hidden md:flex items-center gap-6 bg-white border border-slate-200 px-4 py-2 rounded-xl"
            >
              <div class="text-right">
                <p
                  class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
                >
                  Today's Collection
                </p>
                <p class="text-sm font-black text-emerald-600">$2,450</p>
              </div>
              <div class="h-8 w-px bg-slate-200"></div>
              <div class="text-right">
                <p
                  class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
                >
                  Overdue
                </p>
                <p class="text-sm font-black text-red-600">24</p>
              </div>
            </div>

            <!-- Actions -->
            <div class="flex items-center gap-2">
              <button
                onclick="openModal('sendRemindersModal')"
                class="px-4 py-2 bg-white border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition flex items-center gap-2"
              >
                <i class="fas fa-bell"></i>
                <span class="hidden sm:inline">Reminders</span>
              </button>
              <button
                onclick="openModal('generateInvoiceModal')"
                class="px-4 py-2 bg-white border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition flex items-center gap-2"
              >
                <i class="fas fa-file-invoice"></i>
                <span class="hidden sm:inline">Invoices</span>
              </button>
              <button
                onclick="openModal('recordPaymentModal')"
                class="px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-emerald-200"
              >
                <i class="fas fa-plus-circle"></i>
                <span class="hidden sm:inline">Record Payment</span>
              </button>
            </div>
          </div>
        </header>

        <!-- Tabs Navigation -->
        <div class="border-b border-slate-200 bg-white">
          <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="flex overflow-x-auto">
              <button
                class="tab-button active"
                onclick="switchTab('overview')"
                data-tab="overview"
              >
                <i class="fas fa-chart-pie mr-2"></i>Overview
              </button>
              <button
                class="tab-button"
                onclick="switchTab('payments')"
                data-tab="payments"
              >
                <i class="fas fa-money-check mr-2"></i>Payments
              </button>
              <button
                class="tab-button"
                onclick="switchTab('invoices')"
                data-tab="invoices"
              >
                <i class="fas fa-file-invoice mr-2"></i>Invoices
              </button>
              <button
                class="tab-button"
                onclick="switchTab('reports')"
                data-tab="reports"
              >
                <i class="fas fa-chart-bar mr-2"></i>Reports
              </button>
              <button
                class="tab-button"
                onclick="switchTab('settings')"
                data-tab="settings"
              >
                <i class="fas fa-cog mr-2"></i>Settings
              </button>
            </div>
          </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-y-auto p-6 lg:p-8 custom-scrollbar">
          <!-- Page Header & Filters -->
          <div class="max-w-7xl mx-auto mb-8">
            <div
              class="flex flex-col md:flex-row md:items-center justify-between gap-6"
            >
              <div>
                <h2 class="text-2xl lg:text-3xl font-black text-slate-900 mb-2">
                  Fee Management System
                </h2>
                <p class="text-slate-500 font-medium">
                  Manage fee collection, invoices, and financial reports
                </p>
              </div>
              <div class="flex gap-3">
                <div class="search-box">
                  <input
                    type="text"
                    placeholder="Search student, invoice, or payment..."
                    class="search-input"
                    id="searchInput"
                    onkeyup="filterFees()"
                  />
                  <i class="fas fa-search search-icon"></i>
                </div>
                <button
                  onclick="toggleFilters()"
                  class="px-4 py-2.5 bg-white border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition flex items-center gap-2"
                >
                  <i class="fas fa-filter"></i>
                  <span class="hidden sm:inline">Filters</span>
                </button>
              </div>
            </div>

            <!-- Advanced Filters -->
            <div
              class="glass-card rounded-xl p-6 mt-6 hidden"
              id="advancedFilters"
            >
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-black text-slate-900">
                  Advanced Filters
                </h3>
                <button
                  onclick="toggleFilters()"
                  class="text-slate-400 hover:text-slate-600"
                >
                  <i class="fas fa-times"></i>
                </button>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div>
                  <label class="form-label">Fee Status</label>
                  <select
                    id="filterStatus"
                    class="form-select"
                    onchange="applyFilters()"
                  >
                    <option value="">All Status</option>
                    <option value="paid">Paid</option>
                    <option value="pending">Pending</option>
                    <option value="overdue">Overdue</option>
                    <option value="partial">Partial</option>
                  </select>
                </div>

                <div>
                  <label class="form-label">Academic Year</label>
                  <select
                    id="filterAcademicYear"
                    class="form-select"
                    onchange="applyFilters()"
                  >
                    <option value="">All Years</option>
                    <option value="2024-2025">2024-2025</option>
                    <option value="2023-2024">2023-2024</option>
                    <option value="2022-2023">2022-2023</option>
                  </select>
                </div>

                <div>
                  <label class="form-label">Term</label>
                  <select
                    id="filterTerm"
                    class="form-select"
                    onchange="applyFilters()"
                  >
                    <option value="">All Terms</option>
                    <option value="term1">Term 1</option>
                    <option value="term2">Term 2</option>
                    <option value="term3">Term 3</option>
                    <option value="annual">Annual</option>
                  </select>
                </div>

                <div>
                  <label class="form-label">Date Range</label>
                  <input
                    type="date"
                    id="filterDate"
                    class="form-input"
                    onchange="applyFilters()"
                  />
                </div>
              </div>

              <div
                class="flex justify-between items-center mt-6 pt-6 border-t border-slate-100"
              >
                <button
                  onclick="resetFilters()"
                  class="px-4 py-2 text-slate-600 hover:text-slate-800 transition"
                >
                  Reset All Filters
                </button>
                <button
                  onclick="exportFilteredData()"
                  class="px-6 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:shadow-lg transition-all shadow-lg shadow-indigo-200"
                >
                  Export Filtered Data
                </button>
              </div>
            </div>

            <!-- Filter Chips -->
            <div class="flex flex-wrap gap-2 mt-6">
              <span
                class="filter-chip active"
                onclick="toggleFilter('all')"
                data-filter="all"
              >
                <i class="fas fa-receipt"></i> All Fees
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('paid')"
                data-filter="paid"
              >
                <i class="fas fa-check-circle"></i> Paid (412)
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('pending')"
                data-filter="pending"
              >
                <i class="fas fa-clock"></i> Pending (86)
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('overdue')"
                data-filter="overdue"
              >
                <i class="fas fa-exclamation-triangle"></i> Overdue (24)
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('partial')"
                data-filter="partial"
              >
                <i class="fas fa-percentage"></i> Partial (18)
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('tuition')"
                data-filter="tuition"
              >
                <i class="fas fa-graduation-cap"></i> Tuition Fees
              </span>
              <span
                class="filter-chip"
                onclick="toggleFilter('today')"
                data-filter="today"
              >
                <i class="fas fa-calendar-day"></i> Due Today (12)
              </span>
            </div>
          </div>

          <!-- Key Metrics -->
          <div
            class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"
          >
            <!-- Total Collected Card -->
            <div
              class="glass-card metric-card metric-success rounded-2xl p-6 animate-fadeInUp"
              style="animation-delay: 0.1s"
            >
              <div class="flex items-center justify-between mb-4">
                <div>
                  <p class="text-sm font-bold text-slate-400">
                    TOTAL COLLECTED
                  </p>
                  <p class="text-2xl font-black text-slate-900">$124,580</p>
                </div>
                <div
                  class="w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-50 to-emerald-100 flex items-center justify-center"
                >
                  <i
                    class="fas fa-money-bill-wave text-emerald-600 text-lg"
                  ></i>
                </div>
              </div>
              <div class="flex items-center gap-2 text-sm">
                <span class="text-emerald-600 font-bold"
                  ><i class="fas fa-arrow-up mr-1"></i> 12.5%</span
                >
                <span class="text-slate-500">from last term</span>
              </div>
            </div>

            <!-- Pending Fees Card -->
            <div
              class="glass-card metric-card metric-warning rounded-2xl p-6 animate-fadeInUp"
              style="animation-delay: 0.2s"
            >
              <div class="flex items-center justify-between mb-4">
                <div>
                  <p class="text-sm font-bold text-slate-400">PENDING FEES</p>
                  <p class="text-2xl font-black text-slate-900">$24,320</p>
                </div>
                <div
                  class="w-12 h-12 rounded-xl bg-gradient-to-br from-amber-50 to-amber-100 flex items-center justify-center"
                >
                  <i class="fas fa-clock text-amber-600 text-lg"></i>
                </div>
              </div>
              <div class="fee-progress">
                <div
                  class="fee-progress-fill progress-pending"
                  style="width: 19.5%"
                ></div>
              </div>
              <p class="text-xs text-slate-500 mt-2">19.5% of total fees</p>
            </div>

            <!-- Overdue Fees Card -->
            <div
              class="glass-card metric-card metric-danger rounded-2xl p-6 animate-fadeInUp"
              style="animation-delay: 0.3s"
            >
              <div class="flex items-center justify-between mb-4">
                <div>
                  <p class="text-sm font-bold text-slate-400">OVERDUE FEES</p>
                  <p class="text-2xl font-black text-slate-900">$8,450</p>
                </div>
                <div
                  class="w-12 h-12 rounded-xl bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center"
                >
                  <i
                    class="fas fa-exclamation-triangle text-red-600 text-lg"
                  ></i>
                </div>
              </div>
              <div class="flex items-center gap-2 text-sm">
                <span class="text-red-600 font-bold"
                  ><i class="fas fa-arrow-up mr-1"></i> $1,250</span
                >
                <span class="text-slate-500">from last month</span>
              </div>
            </div>

            <!-- Collection Rate Card -->
            <div
              class="glass-card metric-card metric-success rounded-2xl p-6 animate-fadeInUp"
              style="animation-delay: 0.4s"
            >
              <div class="flex items-center justify-between mb-4">
                <div>
                  <p class="text-sm font-bold text-slate-400">
                    COLLECTION RATE
                  </p>
                  <p class="text-2xl font-black text-slate-900">83.6%</p>
                </div>
                <div
                  class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center"
                >
                  <i class="fas fa-chart-line text-blue-600 text-lg"></i>
                </div>
              </div>
              <div class="fee-progress">
                <div
                  class="fee-progress-fill progress-partial"
                  style="width: 83.6%"
                ></div>
              </div>
              <p class="text-xs text-slate-500 mt-2">+2.4% from last term</p>
            </div>
          </div>

          <!-- Charts & Fee Breakdown -->
          <div
            class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"
          >
            <!-- Fee Collection Chart -->
            <div class="glass-card rounded-2xl p-6 lg:col-span-2">
              <div class="flex items-center justify-between mb-6">
                <div>
                  <h3 class="text-lg font-black text-slate-900">
                    Fee Collection Trend
                  </h3>
                  <p class="text-slate-500">
                    Monthly fee collection for 2024-2025 academic year
                  </p>
                </div>
                <div class="flex items-center gap-2">
                  <button
                    onclick="viewCollectionDetails()"
                    class="text-sm font-bold text-indigo-600 hover:text-indigo-800"
                  >
                    View Details <i class="fas fa-arrow-right ml-1"></i>
                  </button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="collectionChart"></canvas>
              </div>
            </div>

            <!-- Fee Breakdown Summary -->
            <div class="glass-card rounded-2xl p-6">
              <h3 class="text-lg font-black text-slate-900 mb-6">
                Fee Breakdown
              </h3>

              <div class="space-y-4 mb-6">
                <div>
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium text-slate-700"
                      >Tuition Fees</span
                    >
                    <span class="text-sm font-bold text-slate-900"
                      >$89,250</span
                    >
                  </div>
                  <div class="fee-progress">
                    <div
                      class="fee-progress-fill progress-paid"
                      style="width: 71.5%"
                    ></div>
                  </div>
                </div>

                <div>
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium text-slate-700"
                      >Examination Fees</span
                    >
                    <span class="text-sm font-bold text-slate-900"
                      >$15,600</span
                    >
                  </div>
                  <div class="fee-progress">
                    <div
                      class="fee-progress-fill progress-partial"
                      style="width: 12.5%"
                    ></div>
                  </div>
                </div>

                <div>
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium text-slate-700"
                      >Transport Fees</span
                    >
                    <span class="text-sm font-bold text-slate-900"
                      >$12,450</span
                    >
                  </div>
                  <div class="fee-progress">
                    <div
                      class="fee-progress-fill progress-pending"
                      style="width: 10%"
                    ></div>
                  </div>
                </div>

                <div>
                  <div class="flex items-center justify-between mb-1">
                    <span class="text-sm font-medium text-slate-700"
                      >Other Fees</span
                    >
                    <span class="text-sm font-bold text-slate-900">$7,280</span>
                  </div>
                  <div class="fee-progress">
                    <div
                      class="fee-progress-fill progress-overdue"
                      style="width: 5.8%"
                    ></div>
                  </div>
                </div>
              </div>

              <div class="pt-4 border-t border-slate-100">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-sm font-medium text-slate-700"
                    >Total Fee Collection</span
                  >
                  <span class="text-sm font-bold text-slate-900">$124,580</span>
                </div>
                <button
                  onclick="viewFeeBreakdown()"
                  class="w-full py-3 border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition"
                >
                  View Detailed Breakdown
                </button>
              </div>
            </div>
          </div>

          <!-- Recent Payments & Upcoming Due Dates -->
          <div
            class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"
          >
            <!-- Recent Payments -->
            <div class="glass-card rounded-2xl p-6 lg:col-span-2">
              <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-black text-slate-900">
                  Recent Payments
                </h3>
                <button
                  onclick="viewAllPayments()"
                  class="text-sm font-bold text-indigo-600 hover:text-indigo-800"
                >
                  View All <i class="fas fa-arrow-right ml-1"></i>
                </button>
              </div>

              <div class="table-container">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Student</th>
                      <th>Fee Type</th>
                      <th>Amount</th>
                      <th>Date</th>
                      <th>Method</th>
                      <th>Status</th>
                      <th class="w-24">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="recentPaymentsBody">
                    <!-- Payments will be loaded here -->
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Upcoming Due Dates -->
            <div class="glass-card rounded-2xl p-6">
              <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-black text-slate-900">
                  Upcoming Due Dates
                </h3>
                <span class="text-xs font-bold text-slate-400"
                  >December 2024</span
                >
              </div>

              <div class="space-y-4">
                <div
                  class="p-4 bg-emerald-50 border border-emerald-200 rounded-xl"
                >
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <div
                        class="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center"
                      >
                        <i class="fas fa-calendar-check text-emerald-600"></i>
                      </div>
                      <span class="font-bold text-slate-900">Term 2 Fees</span>
                    </div>
                    <span class="due-date due-future">Dec 31</span>
                  </div>
                  <p class="text-sm text-slate-600">
                    Due date for Term 2 tuition fees
                  </p>
                </div>

                <div class="p-4 bg-amber-50 border border-amber-200 rounded-xl">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <div
                        class="w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center"
                      >
                        <i class="fas fa-clock text-amber-600"></i>
                      </div>
                      <span class="font-bold text-slate-900">Exam Fees</span>
                    </div>
                    <span class="due-date due-soon">Dec 15</span>
                  </div>
                  <p class="text-sm text-slate-600">
                    Annual examination fees deadline
                  </p>
                </div>

                <div class="p-4 bg-red-50 border border-red-200 rounded-xl">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <div
                        class="w-8 h-8 rounded-lg bg-red-100 flex items-center justify-center"
                      >
                        <i class="fas fa-exclamation-triangle text-red-600"></i>
                      </div>
                      <span class="font-bold text-slate-900">Overdue Fees</span>
                    </div>
                    <span class="due-date due-today">Today</span>
                  </div>
                  <p class="text-sm text-slate-600">
                    24 students with overdue payments
                  </p>
                </div>

                <div class="p-4 bg-blue-50 border border-blue-200 rounded-xl">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <div
                        class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center"
                      >
                        <i class="fas fa-bus text-blue-600"></i>
                      </div>
                      <span class="font-bold text-slate-900"
                        >Transport Fees</span
                      >
                    </div>
                    <span class="due-date due-future">Dec 20</span>
                  </div>
                  <p class="text-sm text-slate-600">
                    Monthly transport fees collection
                  </p>
                </div>
              </div>

              <button
                onclick="viewAllDueDates()"
                class="w-full mt-6 py-3 border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition"
              >
                View Calendar
              </button>
            </div>
          </div>

          <!-- Fee Invoices Table -->
          <div class="max-w-7xl mx-auto glass-card rounded-2xl p-6 mb-8">
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-lg font-black text-slate-900">Fee Invoices</h3>
              <div class="flex items-center gap-3">
                <div class="search-box" style="max-width: 300px">
                  <input
                    type="text"
                    placeholder="Search invoices..."
                    class="search-input"
                    id="invoiceSearch"
                    onkeyup="filterInvoices()"
                  />
                  <i class="fas fa-search search-icon"></i>
                </div>
                <button
                  onclick="openModal('generateInvoiceModal')"
                  class="action-btn action-btn-primary"
                >
                  <i class="fas fa-plus"></i> Generate Invoice
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="w-12">
                      <input
                        type="checkbox"
                        class="rounded border-slate-300"
                        id="selectAllInvoices"
                      />
                    </th>
                    <th>Invoice #</th>
                    <th>Student</th>
                    <th>Fee Type</th>
                    <th>Amount</th>
                    <th>Due Date</th>
                    <th>Status</th>
                    <th class="w-32">Actions</th>
                  </tr>
                </thead>
                <tbody id="feeInvoicesBody">
                  <!-- Invoices will be loaded here -->
                </tbody>
              </table>
            </div>

            <div class="flex items-center justify-between mt-6">
              <div class="text-sm text-slate-500">
                Showing <span id="showingCount">10</span> of
                <span id="totalCount">124</span> invoices
              </div>
              <div class="flex items-center gap-2">
                <button class="pagination-btn" onclick="previousPage()">
                  <i class="fas fa-chevron-left"></i>
                </button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn" onclick="goToPage(2)">2</button>
                <button class="pagination-btn" onclick="goToPage(3)">3</button>
                <span class="px-2">...</span>
                <button class="pagination-btn" onclick="goToPage(13)">
                  13
                </button>
                <button class="pagination-btn" onclick="nextPage()">
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>

          <!-- Quick Actions & Payment Methods -->
          <div
            class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"
          >
            <!-- Quick Actions -->
            <div class="glass-card rounded-2xl p-6 lg:col-span-2">
              <h3 class="text-lg font-black text-slate-900 mb-6">
                Quick Actions
              </h3>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div
                  class="summary-card"
                  style="background: linear-gradient(135deg, #f0fdf4, #dcfce7)"
                >
                  <div
                    class="w-12 h-12 rounded-xl bg-emerald-100 flex items-center justify-center mb-4 mx-auto"
                  >
                    <i
                      class="fas fa-money-bill-wave text-emerald-600 text-lg"
                    ></i>
                  </div>
                  <div class="summary-value">$2,450</div>
                  <div class="summary-label">Today's Collection</div>
                  <button
                    onclick="viewTodayCollection()"
                    class="mt-4 px-6 py-2 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition"
                  >
                    View Details
                  </button>
                </div>

                <div
                  class="summary-card"
                  style="background: linear-gradient(135deg, #fffbeb, #fef3c7)"
                >
                  <div
                    class="w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center mb-4 mx-auto"
                  >
                    <i class="fas fa-clock text-amber-600 text-lg"></i>
                  </div>
                  <div class="summary-value">24</div>
                  <div class="summary-label">Overdue Students</div>
                  <button
                    onclick="viewOverdueStudents()"
                    class="mt-4 px-6 py-2 bg-amber-600 text-white font-bold rounded-xl hover:bg-amber-700 transition"
                  >
                    Send Reminders
                  </button>
                </div>
              </div>
            </div>

            <!-- Payment Methods -->
            <div class="glass-card rounded-2xl p-6">
              <h3 class="text-lg font-black text-slate-900 mb-6">
                Payment Methods
              </h3>

              <div class="space-y-4">
                <div
                  class="payment-method"
                  onclick="selectPaymentMethod('cash')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center"
                  >
                    <i class="fas fa-money-bill text-green-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">Cash</p>
                    <p class="text-sm text-slate-500">32% of payments</p>
                  </div>
                  <div class="text-right">
                    <span class="text-lg font-black">$39,865</span>
                  </div>
                </div>

                <div
                  class="payment-method selected"
                  onclick="selectPaymentMethod('bank_transfer')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center"
                  >
                    <i class="fas fa-university text-blue-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">Bank Transfer</p>
                    <p class="text-sm text-slate-500">45% of payments</p>
                  </div>
                  <div class="text-right">
                    <span class="text-lg font-black">$56,061</span>
                  </div>
                </div>

                <div
                  class="payment-method"
                  onclick="selectPaymentMethod('online')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center"
                  >
                    <i class="fas fa-globe text-purple-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">Online Payment</p>
                    <p class="text-sm text-slate-500">18% of payments</p>
                  </div>
                  <div class="text-right">
                    <span class="text-lg font-black">$22,424</span>
                  </div>
                </div>

                <div
                  class="payment-method"
                  onclick="selectPaymentMethod('check')"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center"
                  >
                    <i class="fas fa-money-check text-red-600"></i>
                  </div>
                  <div class="text-left">
                    <p class="font-bold">Check</p>
                    <p class="text-sm text-slate-500">5% of payments</p>
                  </div>
                  <div class="text-right">
                    <span class="text-lg font-black">$6,230</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Collection Calendar & Installment Plans -->
          <div class="max-w-7xl mx-auto glass-card rounded-2xl p-6">
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-lg font-black text-slate-900">
                Collection Calendar & Installment Plans
              </h3>
              <button
                onclick="viewCollectionAnalytics()"
                class="text-sm font-bold text-indigo-600 hover:text-indigo-800"
              >
                View Analytics <i class="fas fa-arrow-right ml-1"></i>
              </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <!-- Collection Calendar -->
              <div>
                <h4 class="text-md font-black text-slate-900 mb-4">
                  December 2024
                </h4>
                <div class="collection-calendar mb-4">
                  <div class="calendar-day">S</div>
                  <div class="calendar-day">M</div>
                  <div class="calendar-day">T</div>
                  <div class="calendar-day">W</div>
                  <div class="calendar-day">T</div>
                  <div class="calendar-day">F</div>
                  <div class="calendar-day">S</div>

                  <div class="calendar-day">1</div>
                  <div class="calendar-day">2</div>
                  <div class="calendar-day collected">3</div>
                  <div class="calendar-day collected">4</div>
                  <div class="calendar-day collected">5</div>
                  <div class="calendar-day collected">6</div>
                  <div class="calendar-day">7</div>

                  <div class="calendar-day">8</div>
                  <div class="calendar-day pending">9</div>
                  <div class="calendar-day pending">10</div>
                  <div class="calendar-day pending">11</div>
                  <div class="calendar-day pending">12</div>
                  <div class="calendar-day overdue">13</div>
                  <div class="calendar-day">14</div>

                  <div class="calendar-day">15</div>
                  <div class="calendar-day">16</div>
                  <div class="calendar-day today">17</div>
                  <div class="calendar-day">18</div>
                  <div class="calendar-day">19</div>
                  <div class="calendar-day">20</div>
                  <div class="calendar-day">21</div>
                </div>
                <p class="text-sm text-slate-600">Today: December 17, 2024</p>
              </div>

              <!-- Installment Plans -->
              <div>
                <h4 class="text-md font-black text-slate-900 mb-4">
                  Installment Plans
                </h4>
                <div class="installment-plan">
                  <div class="installment-card paid">
                    <div class="text-sm font-bold text-slate-400">
                      Installment 1
                    </div>
                    <div class="text-xl font-black text-slate-900 mb-2">
                      $500
                    </div>
                    <div class="text-xs text-slate-500">Paid on Nov 15</div>
                    <span class="fee-status status-paid mt-2">Paid</span>
                  </div>

                  <div class="installment-card pending">
                    <div class="text-sm font-bold text-slate-400">
                      Installment 2
                    </div>
                    <div class="text-xl font-black text-slate-900 mb-2">
                      $500
                    </div>
                    <div class="text-xs text-slate-500">Due Dec 15</div>
                    <span class="fee-status status-pending mt-2">Pending</span>
                  </div>

                  <div class="installment-card">
                    <div class="text-sm font-bold text-slate-400">
                      Installment 3
                    </div>
                    <div class="text-xl font-black text-slate-900 mb-2">
                      $500
                    </div>
                    <div class="text-xs text-slate-500">Due Jan 15</div>
                    <span class="fee-status status-pending mt-2">Upcoming</span>
                  </div>
                </div>
              </div>

              <!-- Status Legend -->
              <div>
                <h4 class="text-md font-black text-slate-900 mb-4">
                  Status Legend
                </h4>
                <div class="status-legend mb-6">
                  <div class="legend-item">
                    <div class="legend-color legend-paid"></div>
                    <span>Paid</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color legend-pending"></div>
                    <span>Pending</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color legend-overdue"></div>
                    <span>Overdue</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color legend-partial"></div>
                    <span>Partial</span>
                  </div>
                </div>

                <div class="pt-4 border-t border-slate-100">
                  <h5 class="text-sm font-bold text-slate-900 mb-3">
                    Quick Stats
                  </h5>
                  <ul class="space-y-2 text-sm text-slate-600">
                    <li class="flex items-center justify-between">
                      <span>Average Payment Time:</span>
                      <span class="font-bold text-emerald-600">3.2 days</span>
                    </li>
                    <li class="flex items-center justify-between">
                      <span>On-time Payments:</span>
                      <span class="font-bold text-emerald-600">78%</span>
                    </li>
                    <li class="flex items-center justify-between">
                      <span>Discounts Given:</span>
                      <span class="font-bold text-blue-600">$2,850</span>
                    </li>
                    <li class="flex items-center justify-between">
                      <span>Late Fees Collected:</span>
                      <span class="font-bold text-amber-600">$1,240</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
          // Toast Notification System
          function showToast(message, type = 'info', duration = 5000) {
              const container = document.getElementById('toastContainer');

              // Create toast element
              const toast = document.createElement('div');
              toast.className = `toast toast-${type}`;

              // Set icon based on type
              let icon = 'fa-info-circle';
              switch(type) {
                  case 'success': icon = 'fa-check-circle'; break;
                  case 'warning': icon = 'fa-exclamation-triangle'; break;
                  case 'error': icon = 'fa-times-circle'; break;
                  default: icon = 'fa-info-circle';
              }

              toast.innerHTML = `
                  <i class="fas ${icon} toast-icon"></i>
                  <div class="toast-content">${message}</div>
                  <button class="toast-close" onclick="this.parentElement.remove()">
                      <i class="fas fa-times"></i>
                  </button>
              `;

              // Add to container
              container.appendChild(toast);

              // Trigger animation
              setTimeout(() => {
                  toast.style.opacity = '1';
                  toast.style.transform = 'translateX(0)';
              }, 10);

              // Auto remove after duration
              if (duration > 0) {
                  setTimeout(() => {
                      toast.classList.add('toast-exit');
                      setTimeout(() => {
                          if (toast.parentElement) {
                              toast.remove();
                          }
                      }, 300);
                  }, duration);
              }
          }

          // Mobile Sidebar Toggle
          function mobileSidebarToggle() {
              const sidebar = document.getElementById('sidebar');
              const overlay = document.getElementById('sidebarOverlay');
              sidebar.classList.toggle('-translate-x-full');
              overlay.classList.toggle('hidden');
          }

          // Modal Functions
          function openModal(modalId) {
              document.getElementById(modalId).classList.remove('hidden');
              document.body.style.overflow = 'hidden';
          }

          function closeModal(modalId) {
              document.getElementById(modalId).classList.add('hidden');
              document.body.style.overflow = 'auto';
          }

          // Tab Switching
          function switchTab(tabName) {
              // Update active tab button
              document.querySelectorAll('.tab-button').forEach(btn => {
                  btn.classList.remove('active');
              });
              document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

              // Show appropriate content
              showToast(`Switched to ${tabName} view`, 'info');
          }

          // Initialize Charts
          let collectionChart;

          function initCharts() {
              // Fee Collection Chart
              const collectionCtx = document.getElementById('collectionChart').getContext('2d');
              collectionChart = new Chart(collectionCtx, {
                  type: 'bar',
                  data: {
                      labels: ['Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                      datasets: [{
                          label: 'Fee Collection ($)',
                          data: [12500, 14200, 11800, 15600, 24500, 13200, 14800, 16200, 13800, 15200, 12800, 14500],
                          backgroundColor: [
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)',
                              'rgba(16, 185, 129, 0.7)'
                          ],
                          borderColor: [
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981',
                              '#10b981'
                          ],
                          borderWidth: 2
                      }]
                  },
                  options: {
                      responsive: true,
                      maintainAspectRatio: false,
                      plugins: {
                          legend: {
                              display: false
                          }
                      },
                      scales: {
                          y: {
                              beginAtZero: true,
                              ticks: {
                                  callback: value => '$' + value.toLocaleString()
                              }
                          }
                      }
                  }
              });
          }

          // Filter Functions
          function toggleFilters() {
              const filters = document.getElementById('advancedFilters');
              filters.classList.toggle('hidden');
          }

          function resetFilters() {
              document.getElementById('filterStatus').value = '';
              document.getElementById('filterAcademicYear').value = '';
              document.getElementById('filterTerm').value = '';
              document.getElementById('filterDate').value = '';
              applyFilters();
              showToast('All filters reset', 'info');
          }

          function applyFilters() {
              // Get filter values
              const status = document.getElementById('filterStatus').value;
              const academicYear = document.getElementById('filterAcademicYear').value;
              const term = document.getElementById('filterTerm').value;
              const date = document.getElementById('filterDate').value;

              // In real app, this would filter the data
              showToast(`Applied filters: ${status || 'All'} status, ${academicYear || 'All'} years`, 'info');
          }

          function filterFees() {
              const searchTerm = document.getElementById('searchInput').value.toLowerCase();
              // This is where you would filter your actual data
              // For demo, just show a toast
              if (searchTerm) {
                  showToast(`Searching for: ${searchTerm}`, 'info');
              }
          }

          function filterInvoices() {
              const searchTerm = document.getElementById('invoiceSearch').value.toLowerCase();
              // Filter invoices table
              showToast(`Searching invoices: ${searchTerm}`, 'info');
          }

          function toggleFilter(filter) {
              const chip = document.querySelector(`[data-filter="${filter}"]`);
              const allChips = document.querySelectorAll('.filter-chip');

              // If clicking "all", deactivate others
              if (filter === 'all') {
                  allChips.forEach(c => c.classList.remove('active'));
                  chip.classList.add('active');
              } else {
                  // Remove active from "all"
                  document.querySelector('[data-filter="all"]').classList.remove('active');
                  // Toggle current filter
                  chip.classList.toggle('active');

                  // If no filters active, activate "all"
                  const activeFilters = document.querySelectorAll('.filter-chip.active');
                  if (activeFilters.length === 0) {
                      document.querySelector('[data-filter="all"]').classList.add('active');
                  }
              }

              // In real app, filter data here
              applyFeeFilters();
          }

          function applyFeeFilters() {
              const activeFilters = Array.from(document.querySelectorAll('.filter-chip.active'))
                  .map(chip => chip.dataset.filter);

              showToast(`Applied ${activeFilters.length} fee filters`, 'info');
          }

          // Payment Management Functions
          let selectedInvoices = new Set();

          function loadRecentPayments() {
              const tableBody = document.getElementById('recentPaymentsBody');
              const samplePayments = [
                  { id: 1, student: 'John Doe', feeType: 'Tuition Fee', amount: '$1,200', date: '2024-12-04', method: 'Bank Transfer', status: 'paid' },
                  { id: 2, student: 'Sarah Johnson', feeType: 'Exam Fee', amount: '$150', date: '2024-12-03', method: 'Cash', status: 'paid' },
                  { id: 3, student: 'Michael Brown', feeType: 'Transport Fee', amount: '$200', date: '2024-12-02', method: 'Online', status: 'paid' },
                  { id: 4, student: 'Emma Wilson', feeType: 'Tuition Fee', amount: '$1,200', date: '2024-12-01', method: 'Check', status: 'partial' },
                  { id: 5, student: 'David Lee', feeType: 'Lab Fee', amount: '$75', date: '2024-11-30', method: 'Bank Transfer', status: 'paid' },
                  { id: 6, student: 'Lisa Chen', feeType: 'Sports Fee', amount: '$50', date: '2024-11-29', method: 'Cash', status: 'paid' },
                  { id: 7, student: 'Alex Garcia', feeType: 'Tuition Fee', amount: '$1,200', date: '2024-11-28', method: 'Online', status: 'paid' },
                  { id: 8, student: 'Maya Patel', feeType: 'Library Fee', amount: '$30', date: '2024-11-27', method: 'Bank Transfer', status: 'paid' },
                  { id: 9, student: 'Ryan Kim', feeType: 'Hostel Fee', amount: '$500', date: '2024-11-26', method: 'Cash', status: 'pending' },
                  { id: 10, student: 'Sophia Williams', feeType: 'Tuition Fee', amount: '$1,200', date: '2024-11-25', method: 'Bank Transfer', status: 'overdue' }
              ];

              tableBody.innerHTML = samplePayments.map(payment => {
                  const statusClass = getStatusClass(payment.status);
                  const amountClass = getAmountClass(payment.status);

                  return `
                      <tr>
                          <td>
                              <div class="flex items-center gap-3">
                                  <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center">
                                      <i class="fas fa-user text-slate-600"></i>
                                  </div>
                                  <span class="font-medium">${payment.student}</span>
                              </div>
                          </td>
                          <td class="font-medium">${payment.feeType}</td>
                          <td>
                              <span class="fee-amount ${amountClass}">${payment.amount}</span>
                          </td>
                          <td class="text-sm text-slate-600">${payment.date}</td>
                          <td>
                              <span class="text-sm text-slate-600">${payment.method}</span>
                          </td>
                          <td>
                              <span class="fee-status ${statusClass}">${payment.status.charAt(0).toUpperCase() + payment.status.slice(1)}</span>
                          </td>
                          <td>
                              <div class="flex items-center gap-2">
                                  <button onclick="viewReceipt(${payment.id})" class="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                                      <i class="fas fa-receipt"></i>
                                  </button>
                                  <button onclick="editPayment(${payment.id})" class="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                                      <i class="fas fa-edit"></i>
                                  </button>
                              </div>
                          </td>
                      </tr>
                  `;
              }).join('');
          }

          function loadFeeInvoices() {
              const tableBody = document.getElementById('feeInvoicesBody');
              const sampleInvoices = [
                  { id: 1, invoiceNo: 'INV-2024-001', student: 'John Doe', feeType: 'Term 2 Tuition', amount: '$1,200', dueDate: '2024-12-31', status: 'paid' },
                  { id: 2, invoiceNo: 'INV-2024-002', student: 'Sarah Johnson', feeType: 'Annual Exam', amount: '$150', dueDate: '2024-12-15', status: 'paid' },
                  { id: 3, invoiceNo: 'INV-2024-003', student: 'Michael Brown', feeType: 'Term 2 Tuition', amount: '$1,200', dueDate: '2024-12-31', status: 'pending' },
                  { id: 4, invoiceNo: 'INV-2024-004', student: 'Emma Wilson', feeType: 'Transport Fee', amount: '$200', dueDate: '2024-12-20', status: 'partial' },
                  { id: 5, invoiceNo: 'INV-2024-005', student: 'David Lee', feeType: 'Term 2 Tuition', amount: '$1,200', dueDate: '2024-12-31', status: 'overdue' },
                  { id: 6, invoiceNo: 'INV-2024-006', student: 'Lisa Chen', feeType: 'Lab Fee', amount: '$75', dueDate: '2024-12-10', status: 'paid' },
                  { id: 7, invoiceNo: 'INV-2024-007', student: 'Alex Garcia', feeType: 'Sports Fee', amount: '$50', dueDate: '2024-12-05', status: 'paid' },
                  { id: 8, invoiceNo: 'INV-2024-008', student: 'Maya Patel', feeType: 'Term 2 Tuition', amount: '$1,200', dueDate: '2024-12-31', status: 'pending' },
                  { id: 9, invoiceNo: 'INV-2024-009', student: 'Ryan Kim', feeType: 'Hostel Fee', amount: '$500', dueDate: '2024-12-25', status: 'pending' },
                  { id: 10, invoiceNo: 'INV-2024-010', student: 'Sophia Williams', feeType: 'Library Fee', amount: '$30', dueDate: '2024-12-08', status: 'overdue' }
              ];

              tableBody.innerHTML = sampleInvoices.map(invoice => {
                  const statusClass = getStatusClass(invoice.status);
                  const amountClass = getAmountClass(invoice.status);
                  const dueDateClass = getDueDateClass(invoice.dueDate, invoice.status);

                  return `
                      <tr>
                          <td>
                              <input type="checkbox" class="invoice-checkbox rounded border-slate-300"
                                     data-id="${invoice.id}" onchange="toggleInvoiceSelection(${invoice.id})">
                          </td>
                          <td class="font-bold text-slate-900">${invoice.invoiceNo}</td>
                          <td>
                              <div class="flex items-center gap-3">
                                  <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center">
                                      <i class="fas fa-user text-slate-600"></i>
                                  </div>
                                  <span class="font-medium">${invoice.student}</span>
                              </div>
                          </td>
                          <td class="font-medium">${invoice.feeType}</td>
                          <td>
                              <span class="fee-amount ${amountClass}">${invoice.amount}</span>
                          </td>
                          <td>
                              <span class="due-date ${dueDateClass}">${invoice.dueDate}</span>
                          </td>
                          <td>
                              <span class="fee-status ${statusClass}">${invoice.status.charAt(0).toUpperCase() + invoice.status.slice(1)}</span>
                          </td> 
                            <td>
                                <div class="flex items-center gap-2">
                                    <button onclick="viewInvoice(${invoice.id})" class="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                                        <i class="fas fa-file-invoice"></i>
                                    </button>
                                    <button onclick="editInvoice(${invoice.id})" class="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteInvoice(${invoice.id})" class="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                      </tr>
                  `;
              }).join('');
          }
          function getStatusClass(status) {
          switch(status) {
              case 'paid': return 'status-paid';
              case 'pending': return 'status-pending';
              case 'overdue': return 'status-overdue';
              case 'partial': return 'status-partial';
              default: return 'status-pending';
          }
      }

      function getAmountClass(status) {
          switch(status) {
              case 'paid': return 'paid';
              case 'pending': return 'pending';
              case 'overdue': return 'overdue';
              case 'partial': return 'partial';
              default: return '';
          }
      }

      function getDueDateClass(dueDate, status) {
          if (status === 'paid') return 'due-future';

          const today = new Date('2024-12-17'); // Fixed date for demo
          const due = new Date(dueDate);
          const diffTime = due - today;
          const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

          if (diffDays < 0) return 'due-today';
          if (diffDays <= 7) return 'due-soon';
          return 'due-future';
      }

      // Invoice Selection
      function toggleInvoiceSelection(invoiceId) {
          const checkbox = document.querySelector(`.invoice-checkbox[data-id="${invoiceId}"]`);
          const bulkEditPanel = document.getElementById('bulkEditPanel');

          if (checkbox.checked) {
              selectedInvoices.add(invoiceId);
          } else {
              selectedInvoices.delete(invoiceId);
          }

          // Update bulk edit count
          const count = selectedInvoices.size;
          document.getElementById('bulkEditCount').textContent = `${count} fees selected`;

          // Show/hide bulk edit panel
          if (count > 0) {
              bulkEditPanel.classList.remove('hidden');
          } else {
              bulkEditPanel.classList.add('hidden');
          }
      }

      // Select All Invoices
      document.getElementById('selectAllInvoices').addEventListener('change', function(e) {
          const checkboxes = document.querySelectorAll('.invoice-checkbox');
          checkboxes.forEach(cb => {
              cb.checked = e.target.checked;
              const invoiceId = parseInt(cb.dataset.id);
              if (e.target.checked) {
                  selectedInvoices.add(invoiceId);
              } else {
                  selectedInvoices.delete(invoiceId);
              }
          });

          // Update UI
          const bulkEditPanel = document.getElementById('bulkEditPanel');
          const count = selectedInvoices.size;
          document.getElementById('bulkEditCount').textContent = `${count} fees selected`;

          if (count > 0) {
              bulkEditPanel.classList.remove('hidden');
          } else {
              bulkEditPanel.classList.add('hidden');
          }
      });

      // Close Bulk Edit
      function closeBulkEdit() {
          selectedInvoices.clear();
          document.querySelectorAll('.invoice-checkbox').forEach(cb => cb.checked = false);
          document.getElementById('selectAllInvoices').checked = false;
          document.getElementById('bulkEditPanel').classList.add('hidden');
      }

      // Bulk Actions
      function applyBulkDiscount() {
          showToast(`Applying discount to ${selectedInvoices.size} selected invoices`, 'info');
      }

      function extendBulkDueDate() {
          showToast(`Extending due date for ${selectedInvoices.size} invoices`, 'info');
      }

      function sendBulkReminders() {
          showToast(`Sending reminders for ${selectedInvoices.size} invoices`, 'info');
      }

      function exportBulkData() {
          showToast(`Exporting ${selectedInvoices.size} selected records`, 'success');
      }

      // Modal Functions Implementation
      function loadStudentFeeDetails() {
          const studentId = document.getElementById('paymentStudent').value;
          if (studentId) {
              // Simulate loading fee details
              document.getElementById('paymentAmountDue').value = '1200.00';
              showToast('Loaded student fee details', 'info');
          }
      }

      function savePayment() {
          const student = document.getElementById('paymentStudent').value;
          const amount = document.getElementById('paymentAmount').value;

          if (!student || !amount) {
              showToast('Please fill all required fields', 'error');
              return;
          }

          // Simulate API call
          showToast('Payment recorded successfully! Receipt generated.', 'success');
          closeModal('recordPaymentModal');

          // Reset form
          document.getElementById('paymentStudent').value = '';
          document.getElementById('paymentAmount').value = '';
          document.getElementById('paymentAmountDue').value = '';

          // Refresh data
          loadRecentPayments();
      }

      function generateInvoice() {
          const type = document.getElementById('invoiceType').value;
          const student = document.getElementById('invoiceStudent').value;

          if (type === 'single' && !student) {
              showToast('Please select a student for single invoice', 'error');
              return;
          }

          // Simulate invoice generation
          showToast(`Invoice generated successfully! ${type === 'single' ? '1 invoice' : 'Bulk invoices'} created.`, 'success');
          closeModal('generateInvoiceModal');

          // Refresh invoices
          loadFeeInvoices();
      }

      function viewReceipt(paymentId) {
          // Load receipt data
          const receiptContent = document.getElementById('receiptContent');
          receiptContent.innerHTML = `
              <div class="receipt-container">
                  <div class="receipt-header">
                      <h2 class="text-2xl font-black text-slate-900 mb-2">Greenwood High School</h2>
                      <p class="text-slate-600">Fee Payment Receipt</p>
                      <p class="text-sm text-slate-500 mt-2">Receipt #: RC-2024-${paymentId.toString().padStart(3, '0')}</p>
                  </div>

                  <div class="grid grid-cols-2 gap-6 mb-6">
                      <div>
                          <p class="text-sm font-bold text-slate-400">STUDENT DETAILS</p>
                          <p class="text-lg font-black text-slate-900">John Doe</p>
                          <p class="text-slate-600">Grade 10A, Roll No: 25</p>
                          <p class="text-slate-600">john.doe@email.com</p>
                      </div>
                      <div class="text-right">
                          <p class="text-sm font-bold text-slate-400">PAYMENT DETAILS</p>
                          <p class="text-lg font-black text-slate-900">December 4, 2024</p>
                          <p class="text-slate-600">Transaction ID: TXN${Date.now()}</p>
                          <span class="fee-status status-paid mt-2">Paid</span>
                      </div>
                  </div>

                  <div class="fee-breakdown mb-6">
                      <div class="breakdown-item">
                          <span>Tuition Fee - Term 2</span>
                          <span class="font-bold">$1,200.00</span>
                      </div>
                      <div class="breakdown-item">
                          <span>Payment Method</span>
                          <span class="font-bold">Bank Transfer</span>
                      </div>
                      <div class="breakdown-item">
                          <span>Transaction Reference</span>
                          <span class="font-bold">BANK-REF-${Date.now().toString().slice(-6)}</span>
                      </div>
                      <div class="breakdown-item">
                          <span class="text-lg font-black">Total Amount Paid</span>
                          <span class="text-lg font-black">$1,200.00</span>
                      </div>
                  </div>

                  <div class="border-t border-slate-200 pt-6">
                      <p class="text-sm text-slate-500">This is an official receipt for school fee payment. Please keep this for your records.</p>
                      <div class="flex justify-between items-center mt-4">
                          <div>
                              <p class="text-sm font-bold text-slate-900">Authorized Signature</p>
                              <p class="text-xs text-slate-500">School Administration</p>
                          </div>
                          <div class="text-right">
                              <p class="text-sm text-slate-500">Receipt generated: ${new Date().toLocaleString()}</p>
                          </div>
                      </div>
                  </div>
              </div>
          `;

          openModal('viewReceiptModal');
      }

      function printReceipt() {
          window.print();
      }

      function emailReceipt() {
          showToast('Receipt sent to email successfully', 'success');
      }

      function selectReminderMethod(method) {
          document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
          event.currentTarget.classList.add('selected');
          document.querySelector(`input[name="reminderMethod"][value="${method}"]`).checked = true;
      }

      function sendReminders() {
          const type = document.getElementById('reminderType').value;
          const method = document.querySelector('input[name="reminderMethod"]:checked').value;

          showToast(`Sending ${type} reminders via ${method}...`, 'info');
          setTimeout(() => {
              showToast('Reminders sent successfully!', 'success');
              closeModal('sendRemindersModal');
          }, 1500);
      }

      function selectPaymentMethod(method) {
          document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
          event.currentTarget.classList.add('selected');
      }

      // Pagination Functions
      function previousPage() {
          showToast('Loading previous page...', 'info');
      }

      function nextPage() {
          showToast('Loading next page...', 'info');
      }

      function goToPage(page) {
          showToast(`Loading page ${page}...`, 'info');
      }

      // View Functions
      function viewAllPayments() {
          switchTab('payments');
          showToast('Loading all payments...', 'info');
      }

      function viewAllDueDates() {
          showToast('Opening due dates calendar...', 'info');
      }

      function viewCollectionDetails() {
          switchTab('reports');
          showToast('Opening collection analytics...', 'info');
      }

      function viewFeeBreakdown() {
          showToast('Loading detailed fee breakdown...', 'info');
      }

      function viewTodayCollection() {
          showToast('Loading today\'s collection details...', 'info');
      }

      function viewOverdueStudents() {
          openModal('sendRemindersModal');
      }

      function viewCollectionAnalytics() {
          switchTab('reports');
          showToast('Loading collection analytics...', 'info');
      }

      function exportFilteredData() {
          showToast('Exporting filtered data to Excel...', 'success');
      }

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', function() {
          initCharts();
          loadRecentPayments();
          loadFeeInvoices();

          // Initialize date pickers
          flatpickr("#paymentDate", {
              dateFormat: "Y-m-d",
              defaultDate: "2024-12-04"
          });

          flatpickr("#invoiceDueDate", {
              dateFormat: "Y-m-d",
              defaultDate: "2024-12-31"
          });

          // Set today's date in filter
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('filterDate').value = today;

          // Show welcome message
          setTimeout(() => {
              showToast('Welcome to Fee Management System!', 'info');
          }, 1000);
      });

      // Handle invoice type change
      document.getElementById('invoiceType').addEventListener('change', function() {
          const type = this.value;
          const singleSection = document.getElementById('singleStudentSection');
          const bulkSection = document.getElementById('bulkSection');

          if (type === 'single') {
              singleSection.classList.remove('hidden');
              bulkSection.classList.add('hidden');
          } else {
              singleSection.classList.add('hidden');
              bulkSection.classList.remove('hidden');
          }
      });

      // View/Edit invoice functions
      function viewInvoice(id) {
          showToast(`Viewing invoice ${id} details...`, 'info');
          // In a real app, you would open a modal with invoice details
      }

      function editInvoice(id) {
          showToast(`Editing invoice ${id}...`, 'info');
          // In a real app, you would open an edit modal
      }

      function sendInvoice(id) {
          showToast(`Sending invoice ${id} to parent...`, 'info');
          // In a real app, you would send via email/SMS
      }

      // Payment edit function
      function editPayment(id) {
          showToast(`Editing payment ${id}...`, 'info');
          // In a real app, you would open an edit modal
      }
    </script>

    <!-- Bulk Edit Panel Styles -->
    <style>
      .bulk-edit-panel {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid #e2e8f0;
        padding: 20px;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        z-index: 999;
        transform: translateY(100%);
        transition: transform 0.3s ease;
      }

      .bulk-edit-panel:not(.hidden) {
        transform: translateY(0);
      }
    </style>
  </body>
</html>
