# Individual School Tenant
# Located in: /tenant/school-slug/.htaccess

RewriteEngine On

# ---------------------------------------------------------------------
# URL REWRITING
# ---------------------------------------------------------------------
# Remove .php extension
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L]

# ---------------------------------------------------------------------
# DASHBOARD ROUTES
# ---------------------------------------------------------------------
# Admin routes
RewriteRule ^admin/dashboard$ admin/dashboard.php [L]
RewriteRule ^admin/students$ admin/students.php [L]
RewriteRule ^admin/students/add$ admin/students.php?action=add [L]
RewriteRule ^admin/students/([0-9]+)$ admin/view-student.php?id=$1 [L]
RewriteRule ^admin/teachers$ admin/teachers.php [L]
RewriteRule ^admin/classes$ admin/classes.php [L]
RewriteRule ^admin/attendance$ admin/attendance.php [L]
RewriteRule ^admin/fees$ admin/fees.php [L]
RewriteRule ^admin/reports$ admin/reports.php [L]
RewriteRule ^admin/settings$ admin/settings.php [L]

# Teacher routes
RewriteRule ^teacher/dashboard$ teacher/dashboard.php [L]
RewriteRule ^teacher/attendance$ teacher/attendance.php [L]
RewriteRule ^teacher/grades$ teacher/grades.php [L]
RewriteRule ^teacher/assignments$ teacher/assignments.php [L]

# Student routes
RewriteRule ^student/dashboard$ student/dashboard.php [L]
RewriteRule ^student/timetable$ student/timetable.php [L]
RewriteRule ^student/grades$ student/grades.php [L]
RewriteRule ^student/assignments$ student/assignments.php [L]

# Parent routes
RewriteRule ^parent/dashboard$ parent/dashboard.php [L]
RewriteRule ^parent/children$ parent/children.php [L]
RewriteRule ^parent/attendance$ parent/attendance.php [L]
RewriteRule ^parent/fees$ parent/fees.php [L]

# ---------------------------------------------------------------------
# API ROUTES
# ---------------------------------------------------------------------
RewriteRule ^api/students$ api/students.php [L]
RewriteRule ^api/attendance$ api/attendance.php [L]
RewriteRule ^api/grades$ api/grades.php [L]

# ---------------------------------------------------------------------
# SECURITY
# ---------------------------------------------------------------------
# Protect PHP files in includes directory
<FilesMatch "\.(inc|class)\.php$">
    Order allow,deny
    Deny from all
</FilesMatch>

# ---------------------------------------------------------------------
# CACHE CONTROL
# ---------------------------------------------------------------------
<IfModule mod_expires.c>
    # Cache static assets
    ExpiresActive On
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
</IfModule>